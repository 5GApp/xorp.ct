%!PS-Adobe-3.0
%%Creator: groff version 1.16.1
%%CreationDate: Fri Jul 20 11:38:32 2001
%%DocumentNeededResources: font Courier-Bold
%%+ font Times-Bold
%%+ font Times-Roman
%%+ font Times-Italic
%%+ font Courier
%%DocumentSuppliedResources: file non-c-bsr.ps
%%+ file c-bsr.ps
%%+ procset grops 1.16 1
%%Pages: 24
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.16 1
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Italic
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Italic@0 ENC0/Times-Italic RE
/Times-Roman@0 ENC0/Times-Roman RE/Times-Bold@0 ENC0/Times-Bold RE
/Courier-Bold@0 ENC0/Courier-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Courier-Bold@0 SF(Internet Engineering Task Force)72 85 Q(PIM WG)
209.999 E 245.999(INTERNET-DRAFT Bill)72 98 R(Fenner/AT&T)6 E 155.999
(draft-ietf-pim-sm-bsr-01.ps Mark)72 111 R(Handley/ACIRI)6 E
(Roger Kermode/Motorola)371.999 124 Q(David Thaler/Microsoft)371.999 137
Q(20 July 2001)431.999 150 Q(Expires: January 2002)377.999 163 Q/F1 14
/Times-Bold@0 SF(Bootstrap Router \(BSR\) Mechanism f)112.615 188 Q
(or PIM Sparse Mode)-.35 E/F2 11/Times-Bold@0 SF
(Status of this Document)72 233 Q/F3 11/Times-Roman@0 SF(This document \
is an Internet-Draft and is in full conformance with all pro)72 249.6 Q
(visions of Section 10 of)-.165 E(RFC2026.)72 262.6 Q
(Internet-Drafts are w)72 288.6 Q
(orking documents of the Internet Engineering T)-.11 E(ask F)-.88 E
(orce \(IETF\), its areas,)-.165 E(and its w)72 301.6 Q(orking groups.)
-.11 E(Note that other groups may also distrib)5.5 E(ute w)-.22 E
(orking documents as)-.11 E(Internet-Drafts.)72 314.6 Q
(Internet-Drafts are draft documents v)72 340.6 Q
(alid for a maximum of six months and may be updated,)-.275 E
(replaced, or obsoleted by other documents at an)72 353.6 Q 2.75(yt)
-.165 G 2.75(ime. It)-2.75 F(is inappropriate to use Internet- Drafts)
2.75 E(as reference material or to cite them other than as "w)72 366.6 Q
(ork in progress.")-.11 E
(The list of current Internet-Drafts can be accessed at http://www)72
392.6 Q(.ietf.or)-.715 E(g/ietf/1id-abstracts.txt)-.198 E
(The list of Internet-Draft Shado)72 418.6 Q 2.75(wD)-.275 G
(irectories can be accessed at http://www)-2.75 E(.ietf.or)-.715 E
(g/shado)-.198 E -.715(w.)-.275 G(html.).715 E
(This document is a product of the IETF PIM WG.)72 444.6 Q
(Comments should be addressed to the authors,)5.5 E(or the WG')72 457.6
Q 2.75(sm)-.605 G(ailing list at pim@catarina.usc.edu.)-2.75 E F2
(Abstract)267.534 476.6 Q F3(This document speci\214es the Bootstrap Ro\
uter \(BSR\) mechanism for Protocol)97 499.2 Q
(Independent Multicast - Sparse Mode \(PIM-SM\).)97 512.2 Q
(BSR is one w)5.5 E(ay that a PIM-SM)-.11 E(router can learn the set of\
 group-to-RP mappings required in order to function.)97 525.2 Q(The)5.5
E(mechanism is dynamic, lar)97 538.2 Q(gely self-con\214guring, and rob)
-.198 E(ust to router f)-.22 E(ailure.)-.11 E(Fenner/Handle)72 769 Q
(y/K)-.165 E 246.265(ermode/Thaler [P)-.275 F(age 1])-.165 E EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 13/Times-Bold@0 SF -1.196
(Ta)239.126 85 S(ble of Contents)1.196 E/F2 10/Times-Roman@0 SF
(1. Introduction)97 123 Q F0 11(......................)3.56 G F2(3)11.5
E(1.1. Ov)107 135 Q(ervie)-.15 E 2.5(wo)-.25 G 2.5(fB)-2.5 G
(ootstrap and RP Disco)-2.5 E -.15(ve)-.15 G(ry for Global Scope).15 E
F0 11(.......)4.71 G F2(3)11.5 E(1.2. Administrati)107 147 Q -.15(ve)
-.25 G(ly Scoped Multicast and BSR).15 E F0 11(...........)8.81 G F2(4)
11.5 E(2. BSR State and T)97 159 Q(imers)-.35 E F0 11
(...................)5.43 G F2(5)11.5 E
(3. Bootstrap Router Election and RP-Set Distrib)97 171 Q(ution)-.2 E F0
11(...........)1.39 G F2(5)11.5 E(3.1. Sending Candidate-RP-Adv)107 183
Q(ertisements)-.15 E F0 11(.............)1.91 G F2(12)6.5 E
(3.2. Creating the RP-Set at the BSR)107 195 Q F0 11(...............)
5.91 G F2(12)6.5 E(3.3. F)107 207 Q(orw)-.15 E
(arding Bootstrap Messages)-.1 E F0 11(...............)2.57 G F2(13)6.5
E(3.4. Recei)107 219 Q(ving and Using the RP-Set)-.25 E F0 11
(...............)2.56 G F2(13)6.5 E(4. Message F)97 231 Q(ormats)-.15 E
F0 11(....................)10.38 G F2(14)6.5 E(4.1. Bootstrap Message F)
107 243 Q(ormat)-.15 E F0 11(................)10.38 G F2(15)6.5 E
(4.1.1. Semantic Fragmentation of BSMs)117 255 Q F0 11(.............)
5.36 G F2(18)6.5 E(4.2. Candidate-RP-Adv)107 267 Q(ertisement F)-.15 E
(ormat)-.15 E F0 11(.............)9.84 G F2(19)6.5 E(5. Def)97 279 Q
(ault V)-.1 E(alues for T)-1.11 E(imers)-.35 E F0 11(..................)
4.31 G F2(20)6.5 E(6. Security Considerations)97 291 Q F0 11
(..................)12.17 G F2(21)6.5 E(6.1. Possible Threats)107 303 Q
F0 11(...................)10.92 G F2(21)6.5 E(6.2. Limiting Third-P)107
315 Q(arty DoS Attacks)-.15 E F0 11(..............)8.15 G F2(21)6.5 E
(6.3. BS Message Security)107 327 Q F0 11(..................)4.95 G F2
(21)6.5 E(6.4. C-RP-Adv)107 339 Q(ertisement Security)-.15 E F0 11
(...............)11.63 G F2(22)6.5 E(6.5. Denial of Service using IPsec)
107 351 Q F0 11(...............)13.44 G F2(23)6.5 E
(7. Authors' Addresses)97 363 Q F0 11(....................)1.35 G F2(23)
6.5 E(8. References)97 375 Q F0 11(......................)8.58 G F2(24)
6.5 E(9. Ackno)97 387 Q(wledgments)-.25 E F0 11(....................)
5.76 G F2(24)6.5 E F0(Fenner/Handle)72 769 Q(y/K)-.165 E 246.265
(ermode/Thaler [P)-.275 F(age 2])-.165 E EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF(1.)72 85
Q/F2 14/Times-Bold@0 SF(Intr)5.5 E(oduction)-.252 E F0
(Note: this document assumes f)72 101.6 Q(amiliarity with the w)-.11 E
(orkings of Protocol Independent Multicast -)-.11 E
(Sparse Mode, as de\214ned in [1].)72 114.6 Q -.165(Fo)72 131.2 S 2.75
(rc).165 G(orrect operation, e)-2.75 E -.165(ve)-.275 G
(ry PIM Sparse-mode router within a PIM domain must be able to map a)
.165 E(particular global-scope multicast group address to the same RP)72
144.2 Q 5.5(.I)-1.221 G 2.75(ft)-5.5 G(his is not the case then black)
-2.75 E(holes may appear)72 157.2 Q 2.75(,w)-.44 G(here some recei)-2.75
E -.165(ve)-.275 G(rs in the domain cannot recei).165 E .33 -.165(ve s)
-.275 H(ome groups.).165 E 2.75(Ad)5.5 G(omain in)-2.75 E(this conte)72
170.2 Q(xt is a contiguous set of routers that all implement PIM and ar\
e con\214gured to operate)-.165 E(within a common boundary de\214ned by\
 PIM Multicast Border Routers \(PMBRs\). PMBRs connect)72 183.2 Q
(each PIM domain to the rest of the internet.)72 196.2 Q 2.75(AP)72
212.8 S(IM domain may also brok)-2.75 E
(en up into multiple administrati)-.11 E .33 -.165(ve s)-.275 H(cope re)
.165 E(gions - these are re)-.165 E(gions)-.165 E(where a border has be\
en con\214gured so that a range of multicast groups will not be forw)72
225.8 Q(arded)-.11 E(across that border)72 238.8 Q 5.5(.F)-.605 G
(or more information on Administrati)-5.665 E -.165(ve)-.275 G
(ly Scoped IP Multicast, see RFC).165 E 2.75(2365. The)72 251.8 R
(modi\214ed criteria for admin-scoped re)2.75 E(gions are that the re)
-.165 E(gion is con)-.165 E .33 -.165(vex w)-.44 H(ith respect to).165 E
(forw)72 264.8 Q(arding based on the MRIB, and that all PIM routers wit\
hin the same scope re)-.11 E(gion map a)-.165 E
(particular scoped group to the same RP within that re)72 277.8 Q(gion.)
-.165 E(The PIM-SM speci\214cation does not mandate the use of a single\
 mechanism to pro)72 294.4 Q(vide routers)-.165 E
(with the information to perform the group-to-RP mapping.)72 307.4 Q
(This document describes the)5.5 E(Bootstrap Router \(BSR\) mechanism.)
72 320.4 Q(BSR w)5.5 E
(as \214rst de\214ned in RFC 2362 [2], which has since)-.11 E
(been obsoleted.)72 333.4 Q(This document pro)5.5 E
(vides an updated speci\214cation of the BSR mechanism from)-.165 E
(RFC 2362, and also e)72 346.4 Q(xtends it to cope with administrati)
-.165 E -.165(ve)-.275 G(ly scoped re).165 E(gion boundaries.)-.165 E F1
(1.1.)72 398.4 Q/F3 13/Times-Bold@0 SF(Ov)5.5 E(er)-.13 E
(view of Bootstrap and RP Disco)-.13 E -.13(ve)-.13 G(ry f).13 E
(or Global Scope)-.325 E F0 2.75(As)72 415 S(mall set of routers from a\
 domain are con\214gured as candidate bootstrap routers \(C-BSRs\) and,)
-2.75 E(through a simple election mechanism, a single BSR is selected f\
or that domain. A set of routers)72 428 Q(within a domain are also con\
\214gured as candidate RPs \(C-RPs\); typically these will be the same)
72 441 Q(routers that are con\214gured as C-BSRs.)72 454 Q
(Candidate RPs periodically unicast Candidate-RP-)5.5 E(Adv)72 467 Q
(ertisement messages \(C-RP-Advs\) to the BSR of that domain, adv)-.165
E(ertising their willingness to)-.165 E(be an RP)72 480 Q 2.75(.AC)
-1.221 G(-RP-Adv message includes the address of the adv)-2.75 E
(ertising C-RP)-.165 E 2.75(,a)-1.221 G 2.75(sw)-2.75 G(ell as an)-2.75
E(optional list of group addresses and a mask length \214elds, indicati\
ng the group pre\214x\(es\) for which)72 493 Q(the candidac)72 506 Q
2.75(yi)-.165 G 2.75(sa)-2.75 G(dv)-2.75 E(ertised. The BSR then includ\
es a set of these Candidate-RPs \(the RP-Set\),)-.165 E
(along with their corresponding group pre\214x)72 519 Q
(es, in Bootstrap messages it periodically originates.)-.165 E
(Bootstrap messages are distrib)72 532 Q
(uted hop-by-hop throughout the domain.)-.22 E
(All the PIM routers in the domain recei)72 558 Q .33 -.165(ve a)-.275 H
(nd store Bootstrap messages originated by the BSR.).165 E
(When a DR recei)72 571 Q -.165(ve)-.275 G 2.75(sa).165 G 2.75(ni)-2.75
G(ndication of local membership \(typically from IGMP [3] or MLD [4]\) \
or)-2.75 E 2.75(ad)72 584 S(ata pack)-2.75 E(et from a directly connect\
ed host, for a group for which it has no forw)-.11 E(arding state, the)
-.11 E(DR uses a hash function to map the group address to one of the C\
-RPs from the RP-Set whose)72 597 Q(group-pre\214x includes the group \
\(see [1]\). The DR then sends a Join message to)72 610 Q -.11(wa)-.275
G(rds that RP if).11 E(the local host joined the group, or it Re)72 623
Q(gister)-.165 E(-encapsulates and unicasts the data pack)-.22 E
(et to the RP)-.11 E(if the local host sent a pack)72 636 Q
(et to the group.)-.11 E 2.75(AB)72 662 S(ootstrap message indicates li)
-2.75 E -.165(ve)-.275 G(ness of the RPs included therein.).165 E
(If an RP is included in the)5.5 E(message, then it is tagged as `up' a\
t the routers; RPs not included in the message are remo)72 675 Q -.165
(ve)-.165 G(d).165 E(from the list of RPs o)72 688 Q -.165(ve)-.165 G
2.75(rw).165 G(hich the hash algorithm acts. Each router continues to u\
se the contents)-2.75 E(of the most recently recei)72 701 Q -.165(ve)
-.275 G 2.75(dB).165 G
(ootstrap message from the BSR until it accepts a ne)-2.75 E 2.75(wB)
-.275 G(ootstrap)-2.75 E(message.)72 714 Q(Fenner/Handle)72 769 Q(y/K)
-.165 E 188.515(ermode/Thaler Section)-.275 F 2.75(1.1. [P)2.75 F
(age 3])-.165 E EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(If a PIM domain becomes partit\
ioned, each area separated from the old BSR will elect its o)72 85 Q(wn)
-.275 E(BSR, which will distrib)72 98 Q
(ute an RP-Set containing RPs that are reachable within that partition.)
-.22 E(When the partition heals, another election will occur automatica\
lly and only one of the BSRs will)72 111 Q
(continue to send out Bootstrap messages. As is e)72 124 Q
(xpected at the time of a partition or healing,)-.165 E
(some disruption in pack)72 137 Q(et deli)-.11 E -.165(ve)-.275 G
(ry may occur).165 E 2.75(.T)-.605 G
(his time will be on the order of the re)-2.75 E(gion')-.165 E(s)-.605 E
(round-trip time and the bootstrap router timeout v)72 150 Q(alue.)-.275
E/F1 11/Times-Bold@0 SF(1.2.)72 189 Q/F2 13/Times-Bold@0 SF
(Administrati)5.5 E -.13(ve)-.13 G(ly Scoped Multicast and BSR).13 E F0
(Administrati)72 205.6 Q -.165(ve)-.275 G
(ly Scoped IP Multicast, as de\214ned in RFC 2365, permits a netw).165 E
(ork pro)-.11 E(vider to)-.165 E
(con\214gure scope boundaries at multicast routers.)72 218.6 Q
(Such a scope boundary consists of a range of)5.5 E
(multicast addresses \(e)72 231.6 Q
(xpressed as an address and mask\) that the router will not forw)-.165 E
(ard across the)-.11 E(boundary)72 244.6 Q 5.5(.F)-.715 G(or correct op\
eration, such a scope zone border must be complete and con)-5.665 E
-.165(vex)-.44 G 5.5(.B).165 G 2.75(yt)-5.5 G(his)-2.75 E(we mean that \
there must be no path from inside the scoped zone to outside it that do\
es not pass)72 257.6 Q(through a con\214gured scope border router)72
270.6 Q 2.75(,a)-.44 G(nd that the multicast capable path between an)
-2.75 E(y)-.165 E(arbitrary pair of multicast routers in the scope zone\
 must remain in the zone.)72 283.6 Q -.165(Fo)72 309.6 S 2.75(rP).165 G
(IM-SM using BSR to function correctly with admin scoping, there must b\
e a BSR and at)-2.75 E(least one C-RP within e)72 322.6 Q -.165(ve)-.275
G(ry admin scope re).165 E 2.75(gion. Admin)-.165 F
(scope zone boundaries must be)2.75 E
(con\214gured at the Zone Border Routers \(ZBRs\), as the)72 335.6 Q
2.75(yn)-.165 G(eed to \214lter PIM Join messages that)-2.75 E
(might inadv)72 348.6 Q
(ertently cross the border due to error conditions.)-.165 E
(In addition, at least one C-BSR)5.5 E(within the admin scope zone must\
 be con\214gured to be a C-BSR for the admin scope zone')72 361.6 Q(s)
-.605 E(address range.)72 374.6 Q 2.75(As)72 400.6 S
(eparate BSR election will then tak)-2.75 E 2.75(ep)-.11 G
(lace \(using bootstrap messages\) for e)-2.75 E -.165(ve)-.275 G
(ry admin scope).165 E(range \(plus one for the global range\).)72 413.6
Q(Admin scope ranges are identi\214ed in the bootstrap message)5.5 E
(because the group range is mark)72 426.6 Q
(ed \(using the "Admin Scope" bit, pre)-.11 E(viously a "Reserv)-.275 E
(ed" bit\) to)-.165 E(indicate that this is an administrati)72 439.6 Q
.33 -.165(ve s)-.275 H
(cope range, and not just a range that a particular set of RPs).165 E
(are con\214gured to handle.)72 452.6 Q
(Such admin scoped bootstrap message pack)72 478.6 Q
(ets are \215ooded in the normal w)-.11 E(ay)-.11 E 2.75(,b)-.715 G
(ut will not be)-2.97 E(forw)72 491.6 Q(arded by another ZBR across the\
 boundary for that scope zone \(see Section 3.3 for the)-.11 E
(speci\214cs of this\).)72 504.6 Q 1.76 -.88(We d)72 530.6 T 2.75(on).88
G(ot require that C-RPs within the scope zone be con\214gured to kno)
-2.75 E 2.75(wa)-.275 G(bout the scope zone,)-2.75 E(as the)72 543.6 Q
2.75(yc)-.165 G(an learn of its e)-2.75 E
(xistence from bootstrap messages.)-.165 E(Ho)5.5 E(we)-.275 E -.165(ve)
-.275 G .88 -.44(r, w).165 H 2.75(er).44 G(ecommend that router)-2.75 E
-.165(ve)72 556.6 S(ndors implement con\214guration options that allo)
.165 E 2.75(waC)-.275 G(-RP to be con\214gured to be a C-RP for)-2.75 E
(global scope only)72 569.6 Q 2.75(,f)-.715 G
(or one of more admin scopes only)-2.75 E 2.75(,o)-.715 G 2.75(rf)-2.75
G(or all scopes, both global and admin)-2.75 E 2.75(scoped. W)72 582.6 R
2.75(ea)-.88 G(lso recommend that the def)-2.75 E
(ault be that a C-RP is a C-RP for all scopes, both global)-.11 E
(and admin scoped.)72 595.6 Q
(Unless con\214gured otherwise, C-RPs disco)72 621.6 Q -.165(ve)-.165 G
2.75(rt).165 G(he e)-2.75 E
(xistence of the admin scope zone and its group)-.165 E
(range from recei)72 634.6 Q
(ving a bootstrap message from the scope zone')-.275 E 2.75(se)-.605 G
(lected BSR containing the)-2.75 E(scope zone')72 647.6 Q 2.75(sg)-.605
G(roup-range, mark)-2.75 E(ed using the "Admin Scope" bit.)-.11 E 2.75
(AC)5.5 G(-RP stores each elected)-2.75 E(BSR')72 660.6 Q 2.75(sa)-.605
G(ddress and the admin scope range contained in its bootstrap message.)
-2.75 E(It separately)5.5 E(unicasts Candidate-RP-Adv)72 673.6 Q
(ertisement messages to the appropriate BSR for e)-.165 E -.165(ve)-.275
G(ry admin scope).165 E(range within which it is willing to serv)72
686.6 Q 2.75(ea)-.165 G 2.75(sa)-2.75 G 2.75(nR)-2.75 G -1.221(P.)-2.75
G(All PIM routers within a PIM bootstrap domain where admin scope range\
s are in use must be)72 712.6 Q(capable of recei)72 725.6 Q(ving bootst\
rap messages and storing the winning BSR and RPset for all admin)-.275 E
(Fenner/Handle)72 769 Q(y/K)-.165 E 188.515(ermode/Thaler Section)-.275
F 2.75(1.2. [P)2.75 F(age 4])-.165 E EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(scope zones that apply)72 85 Q
5.5(.T)-.715 G
(hus PIM routers that only implement RFC 2362 \(which only allo)-5.5 E
(ws one)-.275 E(BSR per domain\) cannot be used in PIM domains where ad\
min scope zones are con\214gured.)72 98 Q/F1 11/Times-Bold@0 SF(2.)72
137 Q/F2 14/Times-Bold@0 SF(BSR State and T)5.5 E(imers)-.252 E F0 2.75
(AP)72 153.6 S(IM-SM router implementing BSR holds the follo)-2.75 E
(wing state in addition to the state needed for)-.275 E
(PIM-SM operation:)72 166.6 Q/F3 11/Times-Italic@0 SF(At all r)97 183.2
Q(outer)-.495 E(s:)-.11 E F1(List of Acti)122 199.8 Q .22 -.11(ve S)-.11
H(cope Zones).11 E F0(Per Scope Zone:)122 216.4 Q F1(Bootstrap State:)
147 233 Q F0 7.15<8342>172 249.6 S(ootstrap Router')-7.15 E 2.75(sI)
-.605 G 2.75(PA)-2.75 G(ddress)-2.75 E 7.15<8342>172 266.2 S
(SR Priority)-7.15 E 7.15<8342>172 282.8 S(ootstrap T)-7.15 E
(imer \(BST\))-.385 E 7.15<834c>172 299.4 S
(ist of Scope Group-Ranges for this BSR)-7.15 E F1(RP Set)122 316 Q F3
(At a Candidate BSR:)97 332.6 Q F0(Per Scope Zone:)122 349.2 Q 7.15
<834d>147 365.8 S 2.75(ys)-7.15 G(tate: One of ")-2.75 E F1
(Candidate-BSR)A F0(", ")A F1 -.22(Pe)C(nding-BSR).22 E F0(", ")A F1
(Elected-BSR)A F0(")A F3(At a r)97 382.4 Q
(outer that is not a Candidate BSR:)-.495 E F0(Per Scope Zone:)122 399 Q
(My state: One of ")147 415.6 Q F1(Accept Any)A F0(", ")A F1(Accept Pr)A
(eferr)-.198 E(ed)-.198 E F0(")A F1(Scope-Zone Expiry T)147 432.2 Q
(imer: SZT\(Z\))-.198 E F0(Bootstrap state is described in section 3, a\
nd the RP Set is described in section 3.4.)72 448.8 Q(The follo)72 474.8
Q(wing timers are also required:)-.275 E(At the Bootstrap Router only:)
97 491.4 Q(Per Scope Zone \(Z\):)122 508 Q(Per Candidate RP \(C\):)147
524.6 Q F1(C-RP Expiry T)172 541.2 Q(imer: CET\(C,Z\))-.198 E F0
(At the C-RPs only:)97 557.8 Q F1(C-RP Adv)122 574.4 Q(ertisement T)-.11
E(imer: CRPT)-.198 E(3.)72 613.4 Q F2
(Bootstrap Router Election and RP-Set Distrib)5.5 E(ution)-.28 E F0
-.165(Fo)72 630 S 2.75(rs).165 G(implicity)-2.75 E 2.75(,b)-.715 G(oots\
trap messages \(BSMs\) are used in both the BSR election and the RP-Set)
-2.75 E(distrib)72 643 Q(ution mechanisms.)-.22 E(The state-machine for\
 bootstrap messages depends on whether or not a router has been con\214\
gured)72 659.6 Q(to be a Candidate-BSR for a particular scope zone.)72
672.6 Q(The per)5.5 E(-scope-zone state-machine for a C-)-.22 E
(BSR is gi)72 685.6 Q -.165(ve)-.275 G 2.75(nb).165 G(elo)-2.75 E 1.43
-.715(w, f)-.275 H(ollo).715 E(wed by the state-machine for a router th\
at is not con\214gured to be a C-)-.275 E(BSR.)72 698.6 Q(Fenner/Handle)
72 769 Q(y/K)-.165 E 196.765(ermode/Thaler Section)-.275 F 2.75(3. [P)
2.75 F(age 5])-.165 E EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF -.22(Pe)
72 85 S -.407(r-).22 G(Scope-Zone Candidate-BSR State Machine).407 E 48
307 432 480 -252.9 281 72 360.5 PBEGIN
%%BeginDocument: c-bsr.ps
%%Creator: idraw
%%DocumentFonts: Helvetica
%%Pages: 1
%%BoundingBox: 48 307 528 588
%%EndComments

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

/arrowHeight 8 def
/arrowWidth 4 def

/IdrawDict 51 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l w add b translate w neg h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def


%I Idraw 10 Grid 8 8 


Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.956649 0 0 0.956649 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 14.5 176.5 ] concat
%I 5
792 685
891 683
885 605
843 604
808 642
5 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 14.5 176.5 ] concat
%I 5
788 689
811 789
877 788
887 733
829 710
5 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 115.5 177.5 ] concat
%I 5
288 389
241 313
320 290
382 317
338 389
5 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1.00041 -0 -0 1.00041 -333.136 -91.0373 ] concat
%I 5
476 610
442 545
465 477
517 460
582 474
5 BSpl
%I 1
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 78 177.5 ] concat
%I 3
389 427
610 468
657 636
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 78 177.5 ] concat
%I 3
388 427
324 622
175 660
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 78 177.5 ] concat
%I 3
129 688
165 486
339 433
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 68 177.5 ] concat
%I 3
680 685
424 781
193 713
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ -2.18557e-08 0.5 -0.5 -2.18557e-08 488.25 448.25 ] concat
%I 4
149 683
62 839
221 843
168 729
4 BSpl
%I 2
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 68 177.5 ] concat
%I
152 685 48 48 Elli
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 196 49.5 ] concat
%I
152 685 48 48 Elli
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 332 177.5 ] concat
%I
152 685 48 48 Elli
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 391.5 532 ] concat
%I
[
(Elected)
(BSR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 124 531.5 ] concat
%I
[
(Candidate)
(BSR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 252 399.5 ] concat
%I
[
(Pending)
(BSR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 421.502 611.038 ] concat
%I
[
(BS Timer Expires)
([Originate BS Message])
([Set BS Timer )
(to BS Period])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 229.517 515.508 ] concat
%I
[
(Receive Preferred BSM)
([Forward BSM])
([Store RP Set])
([Set BS Timer to BS Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 217.002 596.02 ] concat
%I
[
(Receive Preferred BSM)
([Forward BSM])
([Store RP Set])
([Set BS Timer to BS Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 54.5115 595.009 ] concat
%I
[
(Receive Preferred BSM)
([Forward BSM])
([Store RP Set])
([Set BS Timer )
(  to BS Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 365.021 412.987 ] concat
%I
[
(BS Timer Expires)
([Originate BS Message])
([Set BS Timer to BS Period)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 151.016 457.006 ] concat
%I
[
(BS Timer Expires)
([Set BS Timer)
(  to rand_override])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 51.9955 407.986 ] concat
%I
[
(Receive Non-preferred BSM)
(from Elected BSR)
([Set BS Timer to rand_override])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 300 352.5 ] concat
%I
[
(Receive Non-preferred BSM)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 423 478 ] concat
%I
[
(Receive )
(Non-preferred BSM)
([Originate BS Message])
([Set BS Timer to BS Period])
] Text
End

End %I eop

showpage


end
%%EndDocument
end PEND(Figur)144.191 399.5 Q 2.75(e1)-.198 G 2.75(:P)-2.75 G(er)-2.97
E(-Scope-Zone State-machine f)-.407 E(or a candidate BSR)-.275 E F0
(In tab)72 422.1 Q(ular form this state machine is:)-.22 E .44 LW
503.996 445.85 72 445.85 DL F1(When in C-BSR state)237.733 456.1 Q
503.996 460.85 72 460.85 DL(Ev)85.192 471.1 Q(ent)-.11 E F0(Recei)
173.271 471.1 Q .33 -.165(ve P)-.275 H(referred).165 E(BSM)173.271 484.1
Q(BS T)291.508 471.1 Q(imer Expires)-.385 E(Recei)410.141 471.1 Q .33
-.165(ve n)-.275 H(on-).165 E(preferred BSM)410.141 484.1 Q
(from Elected BSR)410.141 497.1 Q 503.996 501.85 72 501.85 DL
(-> C-BSR state)173.271 512.1 Q(-> P-BSR state)291.508 512.1 Q
(-> P-BSR state)410.141 512.1 Q F1(Action)85.192 538.1 Q F0 -.165(Fo)
173.271 525.1 S(rw).165 E(ard BSM;)-.11 E(Store RP Set; Set)173.271
538.1 Q(BS T)173.271 551.1 Q(imer to BS)-.385 E -.385(Ti)173.271 564.1 S
(meout).385 E(Set BS T)291.508 525.1 Q(imer to)-.385 E(rand_o)291.508
538.1 Q -.165(ve)-.165 G(rride).165 E(Set BS T)410.141 525.1 Q(imer to)
-.385 E(rand_o)410.141 538.1 Q -.165(ve)-.165 G(rride).165 E 503.996
568.85 72 568.85 DL 503.996 460.85 503.996 568.85 DL 390.353 460.85
390.353 568.85 DL 271.72 460.85 271.72 568.85 DL 152.483 460.85 152.483
568.85 DL 154.483 460.85 154.483 568.85 DL 503.996 445.85 503.996 568.85
DL 72 445.85 72 568.85 DL 503.991 593.85 72 593.85 DL F1
(When in P-BSR state)184.183 604.1 Q 503.991 608.85 72 608.85 DL(Ev)
86.01 619.1 Q(ent)-.11 E F0(Recei)181.917 619.1 Q .33 -.165(ve P)-.275 H
(referred).165 E(BSM)181.917 632.1 Q(BS T)302.608 619.1 Q(imer Expires)
-.385 E(Recei)423.695 619.1 Q .33 -.165(ve N)-.275 H(on-).165 E
(preferred BSM)423.695 632.1 Q 503.991 636.85 72 636.85 DL
(-> C-BSR state)181.917 647.1 Q(-> E-BSR state)302.608 647.1 Q
(-> P-BSR state)423.695 647.1 Q F1(Action)86.01 673.1 Q F0 -.165(Fo)
181.917 660.1 S(rw).165 E(ard BSM;)-.11 E(Store RP Set; Set)181.917
673.1 Q(BS T)181.917 686.1 Q(imer to BS)-.385 E -.385(Ti)181.917 699.1 S
(meout).385 E(Originate BSM;)302.608 660.1 Q(Set BS T)302.608 673.1 Q
(imer to)-.385 E(BS Period)302.608 686.1 Q 503.991 703.85 72 703.85 DL
503.991 608.85 503.991 703.85 DL 402.68 608.85 402.68 703.85 DL 281.593
608.85 281.593 703.85 DL 159.902 608.85 159.902 703.85 DL 161.902 608.85
161.902 703.85 DL 503.991 593.85 503.991 703.85 DL 72 593.85 72 703.85
DL(Fenner/Handle)72 769 Q(y/K)-.165 E 196.765(ermode/Thaler Section)
-.275 F 2.75(3. [P)2.75 F(age 6])-.165 E EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E .44 LW 503.998 76.75 72 76.75
DL/F1 11/Times-Bold@0 SF(When in E-BSR state)182.258 87 Q 503.998 91.75
72 91.75 DL(Ev)85.58 102 Q(ent)-.11 E F0(Recei)180.402 102 Q .33 -.165
(ve P)-.275 H(referred).165 E(BSM)180.402 115 Q(BS T)299.803 102 Q
(imer Expires)-.385 E(Recei)419.6 102 Q .33 -.165(ve N)-.275 H(on-).165
E(preferred BSM)419.6 115 Q 503.998 119.75 72 119.75 DL(-> C-BSR state)
180.402 130 Q(-> E-BSR state)299.803 130 Q(-> E-BSR state)419.6 130 Q F1
(Action)85.58 156 Q F0 -.165(Fo)180.402 143 S(rw).165 E(ard BSM;)-.11 E
(Store RP Set; Set)180.402 156 Q(BS T)180.402 169 Q(imer to BS)-.385 E
-.385(Ti)180.402 182 S(meout).385 E(Originate BSM;)299.803 143 Q
(Set BS T)299.803 156 Q(imer to)-.385 E(BS Period)299.803 169 Q
(Originate BSM;)419.6 143 Q(Set BS T)419.6 156 Q(imer to)-.385 E
(BS Period)419.6 169 Q 503.998 186.75 72 186.75 DL 503.998 91.75 503.998
186.75 DL 399.23 91.75 399.23 186.75 DL 279.433 91.75 279.433 186.75 DL
159.032 91.75 159.032 186.75 DL 161.032 91.75 161.032 186.75 DL 503.998
76.75 503.998 186.75 DL 72 76.75 72 186.75 DL 2.75(Ac)72 201 S(andidate\
-BSR may be in one of three states for a particular scope zone:)-2.75 E
F1(Candidate-BSR \(C-BSR\))72 217.6 Q F0
(The router is a candidate to be the BSR for the scope zone, b)97 230.6
Q(ut currently another router is)-.22 E(the preferred BSR.)97 243.6 Q F1
-.22(Pe)72 260.2 S(nding-BSR \(P-BSR\)).22 E F0
(The router is a candidate to be the BSR for the scope zone.)97 273.2 Q
(Currently no other router is the)5.5 E(preferred BSR, b)97 286.2 Q
(ut this router is not yet the BSR.)-.22 E -.165(Fo)5.5 G 2.75(rc).165 G
(omparisons with incoming BS)-2.75 E
(messages, the router treats itself as the BSR.)97 299.2 Q
(This is a temporary state that pre)5.5 E -.165(ve)-.275 G(nts rapid)
.165 E(thrashing of the choice of BSR during BSR election.)97 312.2 Q F1
(Elected-BSR \(E-BSR\))72 328.8 Q F0(The router is the elected bootstra\
p router for the scope zone and it must perform all the BSR)97 341.8 Q
(functions.)97 354.8 Q(On startup, the initial state for this con\214gu\
red scope zone is "Pending-BSR"; the BS T)72 371.4 Q(imer is)-.385 E
(initialized to the BS T)72 384.4 Q(imeout v)-.385 E(alue.)-.275 E
(In addition to the three states, there is one timer:)72 401 Q 7.15
<8354>72 417.6 S(he bootstrap timer \(BS T)-7.15 E(imer\) - that is use\
d to time out old bootstrap router information, and)-.385 E
(used in the election process to terminate P-BSR state.)83 430.6 Q
(Fenner/Handle)72 769 Q(y/K)-.165 E 196.765(ermode/Thaler Section)-.275
F 2.75(3. [P)2.75 F(age 7])-.165 E EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF -.22(Pe)
72 85 S -.407(r-).22 G(Scope-Zone State-machine f).407 E
(or Non-Candidate-BSR Routers)-.275 E 113 417 432 468 -205.846 223 72
313.446 PBEGIN
%%BeginDocument: non-c-bsr.ps
%%Creator: idraw
%%DocumentFonts: Helvetica
%%Pages: 1
%%BoundingBox: 113 417 581 640
%%EndComments

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

/arrowHeight 8 def
/arrowWidth 4 def

/IdrawDict 51 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l w add b translate w neg h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def


%I Idraw 10 Grid 7.5738e-15 7.25873e-43 


Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.956649 0 0 0.956649 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.28429 -0.411314 0.411314 0.28429 81.1905 391.787 ] concat
%I 4
149 683
62 839
221 843
168 729
4 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1.00041 -0 -0 1.00041 -333.136 -91.0373 ] concat
%I 3
614 734
696 715
731 633
3 BSpl
%I 1
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 1.00041 -0 -0 1.00041 -333.136 -91.0373 ] concat
%I 3
477 611
520 703
591 728
3 BSpl
%I 1
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 78 177.5 ] concat
%I 3
131 684
386 552
621 659
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 68 177.5 ] concat
%I 3
680 685
424 781
193 713
3 BSpl
%I 2
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg Black
0 0 0 SetCBg
%I p
1 SetP
%I t
[ -0.280155 -0.414142 0.414142 -0.280155 157.902 770.359 ] concat
%I 4
149 683
62 839
221 843
168 729
4 BSpl
%I 2
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 68 177.5 ] concat
%I
152 685 48 48 Elli
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 332 177.5 ] concat
%I
152 685 48 48 Elli
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 128.5 530 ] concat
%I
[
(Accept)
(Any )
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 389.5 530 ] concat
%I
[
(Accept)
(Preferred)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 235 545 ] concat
%I
[
(BS Timer Expires)
] Text
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 0.5 -0 -0 0.5 204 302.466 ] concat
%I
152 685 48 48 Elli
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -*-helvetica-medium-r-normal-*-12-*-*-*-*-*-*-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 272 655.966 ] concat
%I
[
(No)
(Info)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 133.005 638.982 ] concat
%I
[
(ScopeZone Timer)
(Expires)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 473.5 582.5 ] concat
%I
[
(Receive Preferred BSM)
([Forward BSM])
([Store RP-Set])
([Set BS Timer to BS Timeout])
([Set SZ Timer to SZ Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 208.5 486.5 ] concat
%I
[
(Receive BSM)
([Forward BSM])
([Store RP-Set])
([Set BS Timer to BS Timeout])
([Set SZ Timer to SZ Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 356.992 655.979 ] concat
%I
[
(Receive BSM for)
(unknown Admin Scope)
([Forward BSM])
([Store RP Set])
([Set BS Timer to BS Timeout])
([Set SZ Timer to SZ Timeout])
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f -adobe-helvetica-medium-r-normal--10-100-75-75-p-56-iso8859-1
Helvetica 10 SetF
%I t
[ 1 0 0 1 471 496.5 ] concat
%I
[
(Receive )
(Non-preferred BSM)
] Text
End

End %I eop

showpage


end
%%EndDocument
end PEND(Figur)104.828 352.446 Q 2.75(e2)-.198 G 2.75(:P)-2.75 G(er)
-2.97 E(-Scope-Zone State-machine f)-.407 E(or a r)-.275 E
(outer not con\214gur)-.198 E(ed as C-BSR)-.198 E F0(In tab)72 371.446 Q
(ular form this state machine is:)-.22 E .44 LW 503.996 395.196 72
395.196 DL F1(When in No Inf)236.496 405.446 Q 2.75(os)-.275 G(tate)
-2.75 E 503.996 410.196 72 410.196 DL(Ev)115.585 420.446 Q(ent)-.11 E F0
(Recei)134.528 E .33 -.165(ve B)-.275 H(SM for unkno).165 E
(wn Admin Scope)-.275 E 503.996 425.196 72 425.196 DL(-> AP State)
277.503 435.446 Q -.165(Fo)277.503 448.446 S(rw).165 E
(ard BSM; Store RP-Set;)-.11 E(Set BS T)277.503 461.446 Q(imer to BS T)
-.385 E(imeout;)-.385 E(Set SZ T)277.503 474.446 Q(imer to SZ T)-.385 E
(imeout)-.385 E F1(Action)115.585 454.946 Q 503.996 479.196 72 479.196
DL 503.996 410.196 503.996 479.196 DL 212.125 410.196 212.125 479.196 DL
503.996 395.196 503.996 479.196 DL 72 395.196 72 479.196 DL 504 504.196
72 504.196 DL(When in Accept Any state)226.895 514.446 Q 504 519.196 72
519.196 DL(Ev)97.939 529.446 Q(ent)-.11 E F0(Recei)81.59 E .33 -.165
(ve B)-.275 H(SM).165 E(SZ T)392.536 529.446 Q(imer Expires)-.385 E 504
534.196 72 534.196 DL(-> AP State)206.919 544.446 Q(-> No Info state)
134.192 E F1(Action)97.939 563.946 Q F0 -.165(Fo)206.919 557.446 S(rw)
.165 E(ard BSM; Store)-.11 E(RP-Set; Set BS T)206.919 570.446 Q(imer to)
-.385 E(BS T)206.919 583.446 Q(imeout)-.385 E(cancel timers; clear)
392.536 557.446 Q(state)392.536 570.446 Q 504 588.196 72 588.196 DL
353.627 519.196 353.627 588.196 DL 168.01 519.196 168.01 588.196 DL 504
504.196 504 588.196 DL 72 504.196 72 588.196 DL(Fenner/Handle)72 769 Q
(y/K)-.165 E 196.765(ermode/Thaler Section)-.275 F 2.75(3. [P)2.75 F
(age 8])-.165 E EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E .44 LW 503.995 76.75 72 76.75
DL/F1 11/Times-Bold@0 SF(When in Accept Pr)157.267 87 Q(eferr)-.198 E
(ed state)-.198 E 503.995 91.75 72 91.75 DL(Ev)87.705 102 Q(ent)-.11 E
F0(Recei)170.056 102 Q .33 -.165(ve P)-.275 H(referred).165 E(BSM)
170.056 115 Q(BS T)295.832 102 Q(imer Expires)-.385 E(Recei)422.004 102
Q .33 -.165(ve N)-.275 H(on-).165 E(preferred BSM)422.004 115 Q 503.995
119.75 72 119.75 DL(-> AP State)170.056 130 Q(-> AA State)74.351 E
(-> AP State)72.921 E F1(Action)87.705 156 Q F0 -.165(Fo)170.056 143 S
(rw).165 E(ard BSM;)-.11 E(Store RP-Set; Set)170.056 156 Q(BS T)170.056
169 Q(imer to BS)-.385 E -.385(Ti)170.056 182 S(meout).385 E 503.995
186.75 72 186.75 DL 503.995 91.75 503.995 186.75 DL 398.446 91.75
398.446 186.75 DL 272.274 91.75 272.274 186.75 DL 146.498 91.75 146.498
186.75 DL 503.995 76.75 503.995 186.75 DL 72 76.75 72 186.75 DL 2.75(Ar)
72 214 S
(outer that is not a candidate-BSR may be in one of three states:)-2.75
E F1(No Inf)72 230.6 Q(o)-.275 E F0
(The router has no information about this scope zone.)97 243.6 Q
(This state does not apply if the router)5.5 E(is con\214gured to kno)97
256.6 Q 2.75(wa)-.275 G
(bout this scope zone, or for the global scope zone.)-2.75 E
(When in this)5.5 E(state, no state information is held and no timers r\
un that refer to this scope zone.)97 269.6 Q F1(Accept Any \(AA\))72
286.2 Q F0(The router does not kno)97 299.2 Q 2.75(wo)-.275 G 2.75(fa)
-2.75 G 2.75(na)-2.75 G(cti)-2.75 E .33 -.165(ve B)-.275 H
(SR, and will accept the \214rst bootstrap message it).165 E(sees as gi)
97 312.2 Q(ving the ne)-.275 E 2.75(wB)-.275 G(SR')-2.75 E 2.75(si)-.605
G(dentity and the RP-Set.)-2.75 E(If the router has an RP-Set cached)5.5
E(from an obsolete bootstrap message, it continues to use it.)97 325.2 Q
F1(Accept Pr)72 341.8 Q(eferr)-.198 E(ed \(AP\))-.198 E F0
(The router kno)97 354.8 Q
(ws the identity of the current BSR, and is using the RP-Set pro)-.275 E
(vided by that)-.165 E 2.75(BSR. Only)97 367.8 R(bootstrap messages fro\
m that BSR or from a C-BSR with higher weight than)2.75 E
(the current BSR will be accepted.)97 380.8 Q
(On startup, the initial state for this scope zone is "Accept An)72
397.4 Q(y" for routers that kno)-.165 E 2.75(wa)-.275 G(bout this)-2.75
E(scope zone, either through con\214guration or because the scope zone \
is the global scope which)72 410.4 Q(al)72 423.4 Q -.11(wa)-.11 G(ys e)
.11 E(xists; the SZ T)-.165 E(imer is considered to be al)-.385 E -.11
(wa)-.11 G(ys running for such scope zones.).11 E -.165(Fo)5.5 G 2.75
(rr).165 G(outers)-2.75 E(that do not kno)72 436.4 Q 2.75(wa)-.275 G(bo\
ut a particular scope zone, the initial state is No Info; no timers e)
-2.75 E(xist for the)-.165 E(scope zone.)72 449.4 Q
(In addition to the three states, there are tw)72 466 Q 2.75(ot)-.11 G
(imers:)-2.75 E 7.15<8354>72 482.6 S(he bootstrap timer \(BS T)-7.15 E
(imer\) - that is used to time out old bootstrap router information.)
-.385 E 7.15<8354>72 499.2 S(he scope zone timer \(SZ T)-7.15 E
(imer\) - that is used to time out the scope zone itself if BS messages)
-.385 E(specifying this scope zone stop arri)83 512.2 Q(ving.)-.275 E F1
(Bootstrap Message Pr)72 538.2 Q(ocessing Checks)-.198 E F0
(When a bootstrap message is recei)72 554.8 Q -.165(ve)-.275 G
(d, the follo).165 E(wing initial checks must be performed:)-.275 E
(Fenner/Handle)72 769 Q(y/K)-.165 E 196.765(ermode/Thaler Section)-.275
F 2.75(3. [P)2.75 F(age 9])-.165 E EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Courier@0 SF
(if \( \(DirectlyConnected\(BSM.src_ip_address\) == FALSE\))72 85 Q
(OR \(we have no Hello state for BSM.src_ip_address\)\) {)105 98 Q
(drop the BS message silently)85.2 111 Q(})72 124 Q
(if \(BSM.dst_ip_address == ALL-PIM-ROUTERS group\) {)72 137 Q
(if \( BSM.src_ip_address != RPF_neighbor\(BSM.BSR_ip_address\) \) {)
85.2 150 Q(drop the BS message silently)105 163 Q(})85.2 176 Q 6.6(}e)72
189 S(lse if \(BSM.dst_ip_address is one of my addresses\) {)-6.6 E
(if \( \(Any previous BSM for this scope has been accepted\) {)85.2 202
Q(#)105 215 Q F0(the pack)A(et w)-.11 E(as unicast, b)-.11 E(ut this w)
-.22 E(asn')-.11 E(t)-.198 E F1(#)105 228 Q F0 2.75(aq)C
(uick refresh on startup)-2.75 E F1(drop the BS message silently)105 241
Q(})85.2 254 Q 6.6(}e)72 267 S(lse {)-6.6 E
(drop the BS message silently)85.2 280 Q(})72 293 Q
(if \(the interface the message arrived on is an Admin Scope)72 306 Q
(border for the BSM.first_group_address\) {)98.4 319 Q
(drop the BS message silently)85.2 332 Q(})72 345 Q F0(Basically)72 364
Q 2.75(,t)-.715 G(he pack)-2.75 E(et must ha)-.11 E .33 -.165(ve c)-.22
H(ome from a directly connected neighbor for which we ha).165 E -.165
(ve)-.22 G(acti)72 377 Q .33 -.165(ve H)-.275 H(ello state.).165 E
(It must ha)5.5 E .33 -.165(ve b)-.22 H(een sent to the ALL-PIM-R).165 E
(OUTERS group by the correct)-.44 E(upstream router to)72 390 Q -.11(wa)
-.275 G
(rds the BSR that originated the BS message, or the router must ha).11 E
.33 -.165(ve n)-.22 H 2.75(oB).165 G(SR)-2.75 E
(state \(it just restarted\) and ha)72 403 Q .33 -.165(ve r)-.22 H(ecei)
.165 E -.165(ve)-.275 G 2.75(dt).165 G(he BS message by unicast.)-2.75 E
(In addition it must not ha)5.5 E -.165(ve)-.22 G(arri)72 416 Q -.165
(ve)-.275 G 2.75(do).165 G 2.75(na)-2.75 G 2.75(ni)-2.75 G(nterf)-2.75 E
(ace that is a con\214gured admin scope border for the \214rst group ad\
dress)-.11 E(contained in the BS message.)72 429 Q/F2 11/Times-Bold@0 SF
(BS State-machine T)72 458.6 Q(ransition Ev)-.814 E(ents)-.11 E F0
(If the bootstrap message passes the initial checks abo)72 475.2 Q .33
-.165(ve w)-.165 H(ithout being discarded, then it may).165 E
(cause a state transition e)72 488.2 Q -.165(ve)-.275 G
(nt in one of the abo).165 E .33 -.165(ve s)-.165 H 2.75
(tate-machines. F).165 F(or both candidate and non-)-.165 E
(candidate BSRs, the follo)72 501.2 Q(wing transition e)-.275 E -.165
(ve)-.275 G(nts are de\214ned:).165 E F2(Recei)97 517.8 Q .22 -.11(ve P)
-.11 H -.198(re).11 G(ferr).198 E(ed BSM)-.198 E F0 2.75(Ab)122 530.8 S
(ootstrap message is recei)-2.75 E -.165(ve)-.275 G 2.75(df).165 G
(rom a BSR that has greater than or equal weight than)-2.75 E
(the current BSR.)122 543.8 Q
(In a router is in P-BSR state, then it uses its o)5.5 E
(wn weight as that of)-.275 E(the current BSR.)122 556.8 Q
(The weighting for a BSR is the concatenation in \214x)122 582.8 Q
(ed-precision unsigned arithmetic)-.165 E(of the BSR priority \214eld f\
rom the bootstrap message and the IP address of the BSR)122 595.8 Q(fro\
m the bootstrap message \(with the BSR priority taking the most-signi\
\214cant bits and)122 608.8 Q
(the IP address taking the least signi\214cant bits\).)122 621.8 Q F2
(Recei)97 638.4 Q .22 -.11(ve B)-.11 H(SM).11 E F0 2.75(Ab)122 651.4 S
(ootstrap message is recei)-2.75 E -.165(ve)-.275 G(d, re).165 E -.055
(ga)-.165 G(rdless of BSR weight.).055 E 2.75(An)72 664.4 S
(on-candidate BSM also has the follo)-2.75 E(wing transition e)-.275 E
-.165(ve)-.275 G(nt de\214ned:).165 E F2(Recei)97 681 Q .22 -.11(ve B)
-.11 H(SM f).11 E(or unkno)-.275 E(wn Admin Scope)-.11 E F0(As "Recei)
122 694 Q .33 -.165(ve B)-.275 H(SM", e).165 E
(xcept that the admin scope zone indicated in the BSM w)-.165 E(as not)
-.11 E(pre)122 707 Q(viously kno)-.275 E(wn at this router)-.275 E(.)
-.605 E(Fenner/Handle)72 769 Q(y/K)-.165 E 191.265
(ermode/Thaler Section)-.275 F 2.75(3. [P)2.75 F(age 10])-.165 E EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF
(BS State-machine Actions)72 85 Q F0(The state-machines specify actions\
 that include setting the BS timer to the follo)72 101.6 Q(wing v)-.275
E(alues:)-.275 E F1(BS P)97 118.2 Q(eriod)-.22 E F0(The periodic interv)
122 131.2 Q(al with which bootstrap messages are normally sent.)-.275 E
(The def)5.5 E(ault)-.11 E -.275(va)122 144.2 S(lue is 60 seconds.).275
E F1(BS T)97 160.8 Q(imeout)-.198 E F0(The interv)122 173.8 Q(al after \
which bootstrap router state is timed out if no bootstrap message)-.275
E(from that router has been heard.)122 186.8 Q(The def)5.5 E(ault v)-.11
E(alue is 2 times the BS Period plus 10)-.275 E
(seconds, which is 130 seconds.)122 199.8 Q F1(Randomized Ov)97 216.4 Q
(erride Inter)-.11 E -.11(va)-.11 G(l).11 E F0(The randomized interv)122
229.4 Q(al during which a router a)-.275 E -.22(vo)-.22 G
(ids sending a bootstrap message).22 E(while it w)122 242.4 Q
(aits to see if another router has a higher bootstrap weight.)-.11 E
(This interv)5.5 E(al is to)-.275 E(reduce control message o)122 255.4 Q
-.165(ve)-.165 G(rhead during BSR election.).165 E(The follo)5.5 E
(wing pseudocode is)-.275 E(proposed as an ef)122 268.4 Q
(\214cient implementation of this "randomized" v)-.275 E(alue:)-.275 E
/F2 11/Courier@0 SF
(Delay = 5 + 2 * log_2\(1 + bestPriority - myPriority\))122 287.4 Q 6.6
(+A)174.8 300.4 S(ddrDelay)-6.6 E F0(where)122 323 Q F2(myPriority)2.75
E F0(is the Candidate-BSR')2.75 E 2.75(sc)-.605 G(on\214gured priority)
-2.75 E 2.75(,a)-.715 G(nd)-2.75 E F2(bestPriority)122 336 Q F0(equals:)
2.75 E F2(bestPriority = Max\(storedPriority, myPriority\))122 355 Q F0
(and)122 374 Q F2(AddrDelay)2.75 E F0(is gi)2.75 E -.165(ve)-.275 G 2.75
(nb).165 G 2.75(yt)-2.75 G(he follo)-2.75 E(wing:)-.275 E F2
(if \( bestPriority == myPriority\) {)122 393 Q
(AddrDelay = log_2\(storedAddr - myAddr\) / 16)148.4 406 Q 6.6(}e)122
419 S(lse {)-6.6 E(AddrDelay = 2 - \(myAddr / 2^31\))148.4 432 Q(})122
445 Q F0(where)122 467.6 Q F2(myAddr)2.75 E F0(is the Candidate-BSR')
2.75 E 2.75(sa)-.605 G(ddress,)-2.75 E F2(storedAddr)2.75 E F0
(is the stored BSR')2.75 E(s)-.605 E(address, and)122 480.6 Q F2
(storedPriority)2.75 E F0(is the stored BSR')2.75 E 2.75(sp)-.605 G
(riority)-2.75 E(.)-.715 E F1(SZ P)97 497.2 Q(eriod)-.22 E F0
(The interv)122 510.2 Q
(al after which a router will time out an Admin Scope zone that it has)
-.275 E(dynamically learned.)122 523.2 Q(The interv)5.5 E
(al MUST be lar)-.275 E(ger than the BS T)-.198 E 2.75(imeout. The)-.385
F(def)2.75 E(ault)-.11 E -.275(va)122 536.2 S(lue is ten times the BS T)
.275 E(imeout, which is 1500 seconds.)-.385 E
(In addition to setting the timers, the follo)72 552.8 Q
(wing actions may be triggered by state-changes in the)-.275 E
(state-machines:)72 565.8 Q F1 -.275(Fo)97 582.4 S(rward BSM).275 E F0
(The bootstrap message is forw)122 595.4 Q
(arded out of all multicast-capable interf)-.11 E(aces, e)-.11 E
(xcept the)-.165 E(interf)122 608.4 Q(ace it w)-.11 E(as recei)-.11 E
-.165(ve)-.275 G 2.75(do).165 G(n, or where this w)-2.75 E
(ould cause the BSM to cross an admin-)-.11 E
(scope boundary for the scope zone indicated in the message.)122 621.4 Q
(The source IP address of)5.5 E(the message is the forw)122 634.4 Q
(arding router')-.11 E 2.75(sI)-.605 G 2.75(Pa)-2.75 G
(ddress on the interf)-2.75 E(ace the message is being)-.11 E(forw)122
647.4 Q(arded from, the destination address is ALL-PIM-R)-.11 E
(OUTERS, and the TTL of the)-.44 E(message is set to 1.)122 660.4 Q F1
(Originate BSM)97 677 Q F0 2.75(An)122 690 S .55 -.275(ew b)-2.75 H
(ootstrap message is constructed by the BSR, gi).275 E(ving the BSR')
-.275 E 2.75(sa)-.605 G(ddress and)-2.75 E(BSR priority)122 703 Q 2.75
(,a)-.715 G(nd containing the BSR')-2.75 E 2.75(sc)-.605 G
(hosen RP-Set.)-2.75 E(The message is forw)5.5 E(arded out)-.11 E
(of all multicast-capable interf)122 716 Q(aces, e)-.11 E
(xcept where this w)-.165 E(ould cause the BSM to cross an)-.11 E
(Fenner/Handle)72 769 Q(y/K)-.165 E 191.265(ermode/Thaler Section)-.275
F 2.75(3. [P)2.75 F(age 11])-.165 E EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E
(admin-scope boundary for the scope zone indicated in the message.)122
85 Q(The IP source)5.5 E
(address of the message is the originating router')122 98 Q 2.75(sI)
-.605 G 2.75(Pa)-2.75 G(ddress on the interf)-2.75 E(ace the)-.11 E
(message is being forw)122 111 Q
(arded from, the destination address is ALL-PIM-R)-.11 E(OUTERS,)-.44 E
(and the TTL of the message is set to 1.)122 124 Q/F1 11/Times-Bold@0 SF
(Stor)97 140.6 Q 2.75(eR)-.198 G 2.75(PS)-2.75 G(et)-2.75 E F0
(The RP-Set from the recei)122 153.6 Q -.165(ve)-.275 G 2.75(db).165 G
(ootstrap message is stored and used by the router to)-2.75 E
(decide the RP for each group that the router has state for)122 166.6 Q
5.5(.S)-.605 G(toring this RP Set may)-5.5 E
(cause other state-transitions to occur in the router)122 179.6 Q 5.5
(.T)-.605 G(he BSR')-5.5 E 2.75(sI)-.605 G 2.75(Pa)-2.75 G
(ddress and priority)-2.75 E(from the recei)122 192.6 Q -.165(ve)-.275 G
2.75(db).165 G
(ootstrap message are also stored to be used to decide if future)-2.75 E
(bootstrap messages are preferred.)122 205.6 Q(In addition to the abo)72
222.2 Q .33 -.165(ve s)-.165 H
(tate-machine actions, a DR also unicasts a stored cop).165 E 2.75(yo)
-.11 G 2.75(ft)-2.75 G(he Bootstrap)-2.75 E(message to each ne)72 235.2
Q 2.75(wP)-.275 G(IM neighbor)-2.75 E 2.75(,i)-.44 G
(.e., after the DR recei)-2.75 E -.165(ve)-.275 G 2.75(st).165 G
(he neighbor')-2.75 E 2.75<738c>-.605 G(rst Hello message,)-2.75 E
(and sends a Hello message in response.)72 248.2 Q(It does so e)5.5 E
-.165(ve)-.275 G 2.75(ni).165 G 2.75(ft)-2.75 G(he ne)-2.75 E 2.75(wn)
-.275 G(eighbor becomes the DR.)-2.75 E F1(3.1.)72 274.2 Q/F2 13
/Times-Bold@0 SF(Sending Candidate-RP-Adv)5.5 E(ertisements)-.13 E F0
(Ev)72 290.8 Q(ery C-RP periodically unicasts a C-RP-Adv to the BSR for\
 that scope zone to inform the BSR)-.165 E(of the C-RP')72 303.8 Q 2.75
(sw)-.605 G(illingness to function as an RP)-2.75 E 5.5(.U)-1.221 G
(nless con\214gured otherwise, it does this for)-5.5 E -2.365 -.275
(ev e)72 316.8 T(ry Admin Scope zone for which it has state, and for th\
e global scope zone.).275 E(If the same router)5.5 E(is the BSR for mor\
e than one scope zone, the C-RP-Adv for these scope zones MA)72 329.8 Q
2.75(Yb)-1.155 G 2.75(ec)-2.75 G(ombined)-2.75 E(into a single message.)
72 342.8 Q(If the C-RP is a ZBR for an admin scope zone, then the Admin\
 Scope bit MUST be set in the C-)72 368.8 Q(RP-Adv messages it sends fo\
r that scope zone; otherwise this bit MUST NO)72 381.8 Q 2.75(Tb)-.44 G
2.75(es)-2.75 G 2.75(et. This)-2.75 F
(information is currently only used for logging purposes by the BSR, b)
72 394.8 Q(ut might allo)-.22 E 2.75(wf)-.275 G(or future)-2.75 E -.165
(ex)72 407.8 S(tensions of the protocol.).165 E(The interv)72 433.8 Q(a\
l for sending these messages is subject to local con\214guration at the\
 C-RP)-.275 E 2.75(,b)-1.221 G(ut must be)-2.97 E
(smaller than the HoldT)72 446.8 Q(ime in the C-RP-Adv)-.385 E(.)-.715 E
2.75(AC)72 472.8 S(andidate-RP-Adv)-2.75 E(ertisement carries a list of\
 group address and group mask \214eld pairs.)-.165 E(This)5.5 E
(enables the C-RP router to restrict the adv)72 485.8 Q
(ertisement to certain pre\214x)-.165 E(es or scopes of groups.)-.165 E
(If)5.5 E(the C-RP becomes an RP)72 498.8 Q 2.75(,i)-1.221 G 2.75(tm)
-2.75 G(ay enforce this scope acceptance when recei)-2.75 E(ving Re)
-.275 E(gisters or)-.165 E(Join/Prune messages.)72 511.8 Q(The C-RP pri\
ority \214eld determines which C-RPs get selected by the BSR to be in t\
he RP Set.)72 537.8 Q(Note that a v)72 550.8 Q
(alue of zero is the highest possible priority)-.275 E 5.5(.C)-.715 G
(-RPs should by def)-5.5 E(ault send C-RP-Adv)-.11 E
(messages with the `Priority' \214eld set to 192.)72 563.8 Q
(When a C-RP is being shut do)72 589.8 Q
(wn, it SHOULD immediately send a C-RP-Adv to the BSR for)-.275 E
(each scope for which it is currently serving as an RP; the HoldT)72
602.8 Q(ime in this C-RP-Adv message)-.385 E(should be zero.)72 615.8 Q
(The BSR will then immediately time out the C-RP and generate a ne)5.5 E
2.75(wB)-.275 G(SR)-2.75 E(message remo)72 628.8 Q(ving the shut do)
-.165 E(wn RP from the RPset.)-.275 E F1(3.2.)72 667.8 Q F2(Cr)5.5 E
(eating the RP-Set at the BSR)-.234 E F0(Upon recei)72 684.4 Q
(ving a C-RP-Adv)-.275 E 2.75(,i)-.715 G 2.75(ft)-2.75 G
(he router is not the elected BSR, it silently ignores the message.)
-2.75 E(If the router is the BSR, then it adds the RP address to its lo\
cal pool of candidate RPs.)72 701 Q -.165(Fo)5.5 G 2.75(re).165 G(ach)
-2.75 E(C-RP)72 714 Q 2.75(,t)-1.221 G(he BSR holds the follo)-2.75 E
(wing information:)-.275 E(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015
(ermode/Thaler Section)-.275 F 2.75(3.2. [P)2.75 F(age 12])-.165 E EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF(IP addr)
97 85 Q(ess)-.198 E F0(The IP address of the C-RP)122 98 Q(.)-1.221 E F1
(Gr)97 114.6 Q(oup Pr)-.198 E(e\214x and Mask list)-.198 E F0
(The list of group pre\214x)122 127.6 Q
(es and group masks from the C-RP adv)-.165 E(ertisement.)-.165 E F1
(HoldT)97 144.2 Q(ime)-.198 E F0(The HoldT)122 157.2 Q
(ime from the C-RP-Adv message.)-.385 E
(This is included later in the RP-set)5.5 E
(information in the Bootstrap Message.)122 170.2 Q F1(C-RP Expiry T)97
186.8 Q(imer)-.198 E F0(The C-RP-Expiry T)122 199.8 Q
(imer is used to time out the state associated with a C-RP when the)
-.385 E(BSR f)122 212.8 Q(ails to recei)-.11 E .33 -.165(ve C)-.275 H
(-RP-Adv).165 E(ertisements from it.)-.165 E(The e)5.5 E
(xpiry timer is initialized to)-.165 E(the HoldT)122 225.8 Q
(ime from the RP')-.385 E 2.75(sC)-.605 G(-RP-Adv)-2.75 E 2.75(,a)-.715
G(nd is reset to the HoldT)-2.75 E(ime whene)-.385 E -.165(ve)-.275 G
2.75(raC).165 G(-)-2.75 E(RP-Adv is recei)122 238.8 Q -.165(ve)-.275 G
2.75(df).165 G(rom that C-RP)-2.75 E(.)-1.221 E F1(C-RP Priority)97
255.4 Q F0(The C-RP Priority is used to determine the subset of possibl\
e RPs to use in the RP-)122 268.4 Q(Set. Smaller v)122 281.4 Q
(alues are deemed to be of higher priority than lar)-.275 E(ge ones.)
-.198 E(When the C-RP Expiry T)72 298 Q(imer e)-.385 E
(xpires, the C-RP is remo)-.165 E -.165(ve)-.165 G 2.75(df).165 G
(rom the pool of a)-2.75 E -.275(va)-.22 G(ilable C-RPs.).275 E(The BSR\
 uses the pool of C-RPs to construct the RP-Set which is included in Bo\
otstrap Messages)72 314.6 Q
(and sent to all the routers in the PIM domain.)72 327.6 Q
(The BSR may apply a local polic)5.5 E 2.75(yt)-.165 G 2.75(ol)-2.75 G
(imit the)-2.75 E
(number of Candidate RPs included in the Bootstrap message.)72 340.6 Q
(The BSR may o)5.5 E -.165(ve)-.165 G(rride the pre\214x).165 E(indicat\
ed in a C-RP-Adv unless the `Priority' \214eld from the C-RP-Adv is les\
s than 128.)72 353.6 Q(The Bootstrap message is subdi)72 370.2 Q
(vided into sets of {group-pre\214x, RP- Count, RP-addresses}.)-.275 E
-.165(Fo)5.5 G(r).165 E(each RP-address, the corresponding HoldT)72
383.2 Q(ime is included in the "RP-HoldT)-.385 E(ime" \214eld.)-.385 E
(The)5.5 E(format of the Bootstrap message allo)72 396.2 Q
(ws `semantic fragmentation', if the length of the original)-.275 E
(Bootstrap message e)72 409.2 Q(xceeds the pack)-.165 E
(et maximum boundaries. Ho)-.11 E(we)-.275 E -.165(ve)-.275 G .88 -.44
(r, w).165 H 2.75(er).44 G(ecommend ag)-2.75 E(ainst)-.055 E
(con\214guring a lar)72 422.2 Q(ge number of routers as C-RPs, to reduc\
e the semantic fragmentation required.)-.198 E
(When an elected BSR is being shut do)72 438.8 Q
(wn, it should immediately originate a Bootstrap message)-.275 E
(listing its current RP set, b)72 451.8 Q
(ut with the BSR priority \214eld set to the lo)-.22 E(west priority v)
-.275 E(alue possible.)-.275 E(This will cause the election of a ne)72
464.8 Q 2.75(wB)-.275 G(SR to happen more quickly)-2.75 E(.)-.715 E F1
(3.3.)72 503.8 Q/F2 13/Times-Bold@0 SF -.325(Fo)5.5 G
(rwarding Bootstrap Messages).325 E F0
(Bootstrap messages originate at the BSR, and are hop-by-hop forw)72
520.4 Q(arded by intermediate routers)-.11 E(if the)72 533.4 Q 2.75(yp)
-.165 G(ass the Bootstrap Message Processing Check.)-2.75 E
(Bootstrap messages are multicast to the)5.5 E -.88(`A)72 546.4 S
(LL-PIM-R).88 E(OUTERS' group.)-.44 E(When a BS message is forw)5.5 E
(arded, it is forw)-.11 E(arded out of e)-.11 E -.165(ve)-.275 G(ry).165
E(multicast-capable interf)72 559.4 Q(ace which has PIM neighbors \(e)
-.11 E(xcluding the one o)-.165 E -.165(ve)-.165 G 2.75(rw).165 G
(hich the message)-2.75 E -.11(wa)72 572.4 S 2.75(sr).11 G(ecei)-2.75 E
-.165(ve)-.275 G 2.75(d\). The).165 F -.165(ex)2.75 G
(ception to this is if the interf).165 E(ace is an administrati)-.11 E
.33 -.165(ve s)-.275 H(cope boundary for the).165 E(admin scope zone in\
dicated in the \214rst group address in the BS message pack)72 585.4 Q
2.75(et. The)-.11 F(IP source)2.75 E
(address on the bootstrap message should be set to the forw)72 598.4 Q
(arding router')-.11 E 2.75(sI)-.605 G 2.75(Pa)-2.75 G(ddress on the)
-2.75 E(interf)72 611.4 Q(ace the message is being forw)-.11 E
(arded from.)-.11 E(Bootstrap messages are al)5.5 E -.11(wa)-.11 G
(ys originated or).11 E(forw)72 624.4 Q(arded with an IP TTL v)-.11 E
(alue of 1.)-.275 E F1(3.4.)72 663.4 Q F2(Recei)5.5 E
(ving and Using the RP-Set)-.13 E F0(When a router recei)72 680 Q -.165
(ve)-.275 G 2.75(sa).165 G(nd stores a ne)-2.75 E 2.75(wR)-.275 G
(P-Set, it checks if each of the RPs referred to by)-2.75 E -.165(ex)72
693 S(isting state \(i.e., by \(*,G\), \(*,*,RP\), or \(S,G,rpt\) entri\
es\) is in the ne).165 E 2.75(wR)-.275 G(P-Set.)-2.75 E
(If an RP is not in the ne)72 709.6 Q 2.75(wR)-.275 G
(P-Set, that RP is considered unreachable and the hash algorithm \(see)
-2.75 E(PIM-SM speci\214cation\) is re-performed for each group with lo\
cally acti)72 722.6 Q .33 -.165(ve s)-.275 H(tate that pre).165 E
(viously)-.275 E(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015
(ermode/Thaler Section)-.275 F 2.75(3.4. [P)2.75 F(age 13])-.165 E EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(hashed to that RP)72 85 Q 2.75
(.T)-1.221 G(his will cause those groups to be distrib)-2.75 E
(uted among the remaining RPs.)-.22 E(If the ne)72 101.6 Q 2.75(wR)-.275
G(P-Set contains a RP that w)-2.75 E(as not pre)-.11 E
(viously in the RP-Set, the hash v)-.275 E(alue of the ne)-.275 E(w)
-.275 E(RP is calculated for each group co)72 114.6 Q -.165(ve)-.165 G
(red by the ne).165 E 2.75(wC)-.275 G(-RP')-2.75 E 2.75(sG)-.605 G 2.75
(roup-pre\214x. An)-2.75 F 2.75(yg)-.165 G(roup for which)-2.75 E
(the ne)72 127.6 Q 2.75(wR)-.275 G(P')-2.75 E 2.75(sh)-.605 G(ash v)
-2.75 E(alue is greater than hash v)-.275 E(alue of the group')-.275 E
2.75(sp)-.605 G(re)-2.75 E(vious RP is switched o)-.275 E -.165(ve)-.165
G 2.75(rt).165 G(o)-2.75 E(the ne)72 140.6 Q 2.75(wR)-.275 G -1.221(P.)
-2.75 G/F1 11/Times-Bold@0 SF(4.)72 166.6 Q/F2 14/Times-Bold@0 SF
(Message F)5.5 E(ormats)-.35 E F0
(BSR messages are PIM messages, as de\214ned in [1]. The v)72 183.2 Q
(alues of the PIM message T)-.275 E(ype \214eld for)-.88 E
(BSR messages are:)72 196.2 Q 19.5(4B)72 212.8 S(ootstrap Message)-19.5
E 19.5(8C)72 229.4 S(andidate-RP-Adv)-19.5 E(ertisement)-.165 E
(In this section we use the follo)72 246 Q
(wing terms de\214ned in the PIM-SM [1]:)-.275 E 21.15<8345>72 262.6 S
(ncoded-Unicast format)-21.15 E 21.15<8345>72 279.2 S
(ncoded-Group format)-21.15 E 1.76 -.88(We r)72 295.8 T
(epeat these here to aid readability).88 E(.)-.715 E F1
(Encoded-Unicast addr)72 321.8 Q(ess)-.198 E F0
(An Encoded-Unicast address tak)72 338.4 Q(es the follo)-.11 E
(wing format:)-.275 E/F3 11/Courier@0 SF 125.4(0123)78.6 357.4 S 6.6
(01234567890123456789012345678901)78.6 370.4 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
383.4 Q 13.2(|A)72 396.4 S(ddr Family)-13.2 E 6.6(|E)13.2 G
(ncoding Type |)-6.6 E(Unicast Address)33 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...)72 409.4 Q F1
(Addr F)72 432 Q(amily)-.275 E F0(The PIM address f)97 445 Q
(amily of the `Unicast Address' \214eld of this address.)-.11 E -1.221
(Va)97 461.6 S(lues of 0-127 are as assigned by the IAN)1.221 E 2.75(Af)
-.385 G(or Internet Address F)-2.75 E(amilies in [5]. V)-.165 E(alues)
-1.221 E(128-250 are reserv)97 474.6 Q(ed to be assigned by the IAN)
-.165 E 2.75(Af)-.385 G(or PIM-speci\214c Address F)-2.75 E(amilies.)
-.165 E -1.221(Va)97 487.6 S(lues 251 though 255 are designated for pri)
1.221 E -.275(va)-.275 G(te use.).275 E
(As there is no assignment authority)5.5 E
(for this space, collisions should be e)97 500.6 Q(xpected.)-.165 E F1
(Encoding T)72 517.2 Q(ype)-.814 E F0
(The type of encoding used within a speci\214c Address F)97 530.2 Q
(amily)-.165 E 5.5(.T)-.715 G(he v)-5.5 E(alue `0' is reserv)-.275 E
(ed for)-.165 E(this \214eld, and represents the nati)97 543.2 Q .33
-.165(ve e)-.275 H(ncoding of the Address F).165 E(amily)-.165 E(.)-.715
E F1(Unicast Addr)72 572.8 Q(ess)-.198 E F0
(The unicast address as represented by the gi)97 585.8 Q -.165(ve)-.275
G 2.75(nA).165 G(ddress F)-2.75 E(amily and Encoding T)-.165 E(ype.)-.88
E F1(Encoded-Gr)72 624.8 Q(oup addr)-.198 E(ess)-.198 E F0
(Fenner/Handle)72 769 Q(y/K)-.165 E 191.265(ermode/Thaler Section)-.275
F 2.75(4. [P)2.75 F(age 14])-.165 E EP
%%Page: 15 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(Encoded-Group addresses tak)72
85 Q 2.75(et)-.11 G(he follo)-2.75 E(wing format:)-.275 E/F1 11
/Courier@0 SF 125.4(0123)78.6 104 S 6.6
(01234567890123456789012345678901)78.6 117 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
130 Q 13.2(|A)72 143 S(ddr Family)-13.2 E 6.6(|E)13.2 G(ncoding Type |)
-6.6 E 6.6(Reserved |Z| Mask)19.8 F 26.4(Len |)6.6 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
156 Q 105.6(|G)72 169 S(roup multicast Address)-105.6 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...)72 182 Q/F2 11/Times-Bold@0 SF
(Addr F)72 204.6 Q(amily)-.275 E F0(described abo)97 217.6 Q -.165(ve)
-.165 G(.).165 E F2(Encoding T)72 247.2 Q(ype)-.814 E F0(described abo)
97 260.2 Q -.165(ve)-.165 G(.).165 E F2(Reser)72 289.8 Q -.11(ve)-.11 G
(d).11 E F0 -.385(Tr)97 302.8 S
(ansmitted as zero. Ignored upon receipt.).385 E F2(Admin Scope [Z]one)
72 332.4 Q F0(When set, this bit indicates that this group address rang\
e is an administrati)97 345.4 Q -.165(ve)-.275 G(ly scoped).165 E
(range.)97 358.4 Q F2(Mask Len)72 388 Q F0
(The Mask length \214eld is 8 bits. The v)97 401 Q
(alue is the number of contiguous one bits left justi\214ed)-.275 E(use\
d as a mask which, combined with the group address, describes a range o\
f groups. It is)97 414 Q
(less than or equal to the address length in bits for the gi)97 427 Q
-.165(ve)-.275 G 2.75(nA).165 G(ddress F)-2.75 E(amily and Encoding)
-.165 E -.88(Ty)97 440 S(pe. If the message is sent for a single group \
then the Mask length must equal the address).88 E
(length in bits for the gi)97 453 Q -.165(ve)-.275 G 2.75(nA).165 G
(ddress F)-2.75 E(amily and Encoding T)-.165 E 2.75(ype. \(e.g.)-.88 F
(32 for IPv4 nati)2.75 E -.165(ve)-.275 G
(encoding and 128 for IPv6 nati)97 466 Q .33 -.165(ve e)-.275 H
(ncoding\).).165 E F2(Gr)72 495.6 Q(oup multicast Addr)-.198 E(ess)-.198
E F0(Contains the group address.)97 508.6 Q F2(4.1.)72 547.6 Q/F3 13
/Times-Bold@0 SF(Bootstrap Message F)5.5 E(ormat)-.325 E F0 2.75(Ab)72
577.2 S(ootstrap message is di)-2.75 E
(vided up into `semantic fragments' if the original message e)-.275 E
(xceeds the)-.165 E(maximum pack)72 590.2 Q(et size boundaries.)-.11 E
(Basically)5.5 E 2.75(,as)-.715 G
(ingle bootstrap message can be sent as multiple)-2.75 E(pack)72 603.2 Q
(ets \(semantic fragments\), so long as the fragment tags of all the pa\
ck)-.11 E(ets comprising the)-.11 E(message is the same.)72 616.2 Q(If \
the bootstrap message contains information about more than one admin sc\
ope zone, each)72 642.2 Q(dif)72 655.2 Q(ferent scope zone MUST occup)
-.275 E 2.75(yad)-.11 G(if)-2.75 E(ferent semantic fragment.)-.275 E
(This allo)5.5 E(ws Zone Border)-.275 E
(Routers for an admin scope zone to not forw)72 668.2 Q
(ard only those fragments that should not tra)-.11 E -.165(ve)-.22 G
(rse the).165 E(admin scope boundary)72 681.2 Q(.)-.715 E
(The format of a single `fragment' is gi)72 707.2 Q -.165(ve)-.275 G
2.75(nb).165 G(elo)-2.75 E(w:)-.275 E(Fenner/Handle)72 769 Q(y/K)-.165 E
183.015(ermode/Thaler Section)-.275 F 2.75(4.1. [P)2.75 F(age 15])-.165
E EP
%%Page: 16 16
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Courier@0 SF 125.4(0123)
78.6 85 S 6.6(01234567890123456789012345678901)78.6 98 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
111 Q(|PIM Ver| Type)72 124 Q 19.8(|R)13.2 G 19.8(eserved |)-19.8 F 72.6
(Checksum |)72.6 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
137 Q 59.4(|F)72 150 S(ragment Tag)-59.4 E 6.6(|H)66 G
(ash Mask len | BSR-priority)-6.6 E(|)13.2 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
163 Q 85.8(|B)72 176 S(SR Address \(Encoded-Unicast format\))-85.8 E(|)
92.4 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
189 Q 79.2(|G)72 202 S(roup Address 1 \(Encoded-Group format\))-79.2 E
(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
215 Q 6.6(|R)72 228 S 6.6(PC)-6.6 G(ount 1)-6.6 E 6.6(|F)26.4 G
(rag RP Cnt 1 |)-6.6 E 85.8(Reserved |)59.4 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
241 Q 85.8(|R)72 254 S 6.6(PA)-85.8 G
(ddress 1 \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
267 Q 66(|R)72 280 S(P1 Holdtime)-66 E 6.6(|R)59.4 G(P1 Priority)-6.6 E
19.8(|R)13.2 G 19.8(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
293 Q 85.8(|R)72 306 S 6.6(PA)-85.8 G
(ddress 2 \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
319 Q 66(|R)72 332 S(P2 Holdtime)-66 E 6.6(|R)59.4 G(P2 Priority)-6.6 E
19.8(|R)13.2 G 19.8(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
345 Q 204.6(|.|)72 358 S 204.6(|.|)72 371 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
384 Q 85.8(|R)72 397 S 6.6(PA)-85.8 G
(ddress m \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
410 Q 66(|R)72 423 S(Pm Holdtime)-66 E 6.6(|R)59.4 G(Pm Priority)-6.6 E
19.8(|R)13.2 G 19.8(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
436 Q 79.2(|G)72 449 S(roup Address 2 \(Encoded-Group format\))-79.2 E
(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
462 Q 204.6(|.|)72 475 S 204.6(|.|)72 488 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
501 Q 79.2(|G)72 514 S(roup Address n \(Encoded-Group format\))-79.2 E
(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
527 Q 6.6(|R)72 540 S 6.6(PC)-6.6 G(ount n)-6.6 E 6.6(|F)26.4 G
(rag RP Cnt n |)-6.6 E 79.2(Reserved |)66 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
553 Q 85.8(|R)72 566 S 6.6(PA)-85.8 G
(ddress 1 \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
579 Q 66(|R)72 592 S(P1 Holdtime)-66 E 6.6(|R)59.4 G(P1 Priority)-6.6 E
19.8(|R)13.2 G 19.8(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
605 Q 85.8(|R)72 618 S 6.6(PA)-85.8 G
(ddress 2 \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
631 Q 66(|R)72 644 S(P2 Holdtime)-66 E 6.6(|R)59.4 G(P2 Priority)-6.6 E
19.8(|R)13.2 G 19.8(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
657 Q 204.6(|.|)72 670 S 204.6(|.|)72 683 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
696 Q 85.8(|R)72 709 S 6.6(PA)-85.8 G
(ddress m \(Encoded-Unicast format\))-6.6 E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
722 Q F0(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015
(ermode/Thaler Section)-.275 F 2.75(4.1. [P)2.75 F(age 16])-.165 E EP
%%Page: 17 17
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Courier@0 SF 66(|R)72 85
S(Pm Holdtime)-66 E 6.6(|R)59.4 G(Pm Priority)-6.6 E 19.8(|R)13.2 G 19.8
(eserved |)-19.8 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72 98
Q/F2 11/Times-Bold@0 SF(PIM V)72 120.6 Q(ersion, Reser)-1.1 E -.11(ve)
-.11 G(d, Checksum).11 E F0(Described in [1].)97 133.6 Q F2 -.814(Ty)72
150.2 S(pe).814 E F0(PIM Message T)97 163.2 Q 2.75(ype. V)-.88 F
(alue is 8 for a Bootstrap Message.)-1.221 E F2(Fragment T)72 192.8 Q
(ag)-1.012 E F0 2.75(Ar)97 205.8 S(andomly generated number)-2.75 E 2.75
(,a)-.44 G(cts to distinguish the fragments belonging to dif)-2.75 E
(ferent)-.275 E(Bootstrap messages; fragments belonging to same Bootstr\
ap message carry the same)97 218.8 Q(`Fragment T)97 231.8 Q(ag'.)-.88 E
F2(Hash Mask len)72 261.4 Q F0
(The length \(in bits\) of the mask to use in the hash function. F)97
274.4 Q(or IPv4 we recommend a v)-.165 E(alue)-.275 E(of 30. F)97 287.4
Q(or IPv6 we recommend a v)-.165 E(alue of 126.)-.275 E F2(BSR priority)
72 317 Q F0(Contains the BSR priority v)97 330 Q
(alue of the included BSR.)-.275 E(This \214eld is considered as a high)
5.5 E(order byte when comparing BSR addresses.)97 343 Q
(Note that for historical reasons, the highest)5.5 E(BSR priority prior\
ity is 255 \(the higher the better\), whereas the highest RP Priority \
\(see)97 356 Q(belo)97 369 Q(w\) is 0 \(the lo)-.275 E
(wer the better\).)-.275 E F2(Unicast BSR Addr)72 398.6 Q(ess)-.198 E F0
(The address of the bootstrap router for the domain.)97 411.6 Q
(The format for this address is gi)5.5 E -.165(ve)-.275 G 2.75(ni).165 G
(n)-2.75 E(the Encoded-Unicast address in [1].)97 424.6 Q F2(Gr)72 441.2
Q(oup Addr)-.198 E(ess 1..n)-.198 E F0(The group pre\214x \(address and\
 mask\) with which the Candidate RPs are associated.)97 454.2 Q -.165
(Fo)5.5 G(rmat).165 E(described in [1]. In a fragment containing admin \
scope ranges, the \214rst group address in the)97 467.2 Q(fragment MUST\
 be the group range for the entire admin scope range, and this MUST ha)
97 480.2 Q -.165(ve)-.22 G(the Admin Scope bit set.)97 493.2 Q
(This is the case e)5.5 E -.165(ve)-.275 G 2.75(ni).165 G 2.75(ft)-2.75
G(here are no RPs in the RP set for the)-2.75 E(entire admin scope rang\
e - in this case the sub-ranges for the RP set are speci\214ed later in\
 the)97 506.2 Q(fragment along with their RPs.)97 519.2 Q F2
(RP Count 1..n)72 548.8 Q F0(The number of Candidate RP addresses inclu\
ded in the whole Bootstrap message for the)97 561.8 Q(corresponding gro\
up pre\214x. A router does not replace its old RP-Set for a gi)97 574.8
Q -.165(ve)-.275 G 2.75(ng).165 G(roup)-2.75 E
(pre\214x until/unless it recei)97 587.8 Q -.165(ve)-.275 G 2.75(s`).165
G(RP-Count' addresses for that pre\214x; the addresses could be)-2.75 E
(carried o)97 600.8 Q -.165(ve)-.165 G 2.75(rs).165 G -2.365 -.275(ev e)
-2.75 H(ral fragments.).275 E(If only part of the RP-Set for a gi)5.5 E
-.165(ve)-.275 G 2.75(ng).165 G(roup pre\214x w)-2.75 E(as)-.11 E(recei)
97 613.8 Q -.165(ve)-.275 G(d, the router discards it, without updating\
 that speci\214c group pre\214x').165 E 2.75(sR)-.605 G(P-Set.)-2.75 E
F2(Frag RP Cnt 1..m)72 643.4 Q F0(The number of Candidate RP addresses \
included in this fragment of the Bootstrap message,)97 656.4 Q
(for the corresponding group pre\214x. The `Frag RP-Cnt' \214eld f)97
669.4 Q(acilitates parsing of the RP-Set)-.11 E(for a gi)97 682.4 Q
-.165(ve)-.275 G 2.75(ng).165 G(roup pre\214x, when carried o)-2.75 E
-.165(ve)-.165 G 2.75(rm).165 G(ore than one fragment.)-2.75 E F2
(RP addr)72 712 Q(ess 1..m)-.198 E F0(The address of the Candidate RPs,\
 for the corresponding group pre\214x.)97 725 Q(The format for these)5.5
E(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015(ermode/Thaler Section)-.275
F 2.75(4.1. [P)2.75 F(age 17])-.165 E EP
%%Page: 18 18
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(addresses is gi)97 85 Q -.165
(ve)-.275 G 2.75(ni).165 G 2.75(nt)-2.75 G
(he Encoded-Unicast address in [1].)-2.75 E/F1 11/Times-Bold@0 SF
(RP1..m Holdtime)72 101.6 Q F0(The Holdtime for the corresponding RP)97
114.6 Q 5.5(.T)-1.221 G
(his \214eld is copied from the `Holdtime' \214eld of)-5.5 E
(the associated RP stored at the BSR.)97 127.6 Q F1(RP1..m Priority)72
157.2 Q F0
(The `Priority' of the corresponding RP and Encoded-Group Address.)97
170.2 Q(This \214eld is copied)5.5 E
(from the `Priority' \214eld stored at the BSR when recei)97 183.2 Q
(ving a Candidate-RP-Adv)-.275 E(ertisement.)-.165 E
(The highest priority is `0' \(i.e. unlik)97 196.2 Q 2.75(eB)-.11 G
(SR priority)-2.75 E 2.75(,t)-.715 G(he lo)-2.75 E(wer the v)-.275 E
(alue of the `Priority')-.275 E(\214eld, the better\).)97 209.2 Q
(Note that the priority is per RP per Group Address.)5.5 E F1 2.75
(4.1.1. Semantic)72 248.2 R(Fragmentation of BSMs)2.75 E F0
(Bootstrap messages may be split o)72 264.8 Q -.165(ve)-.165 G 2.75(rs)
.165 G -2.365 -.275(ev e)-2.75 H
(ral PIM Bootstrap Message Fragment \(BSMF\) pack).275 E(ets;)-.11 E
(this is kno)72 277.8 Q(wn as semantic fragmentation.)-.275 E
(There are tw)5.5 E 2.75(or)-.11 G(easons for semantic fragmentation:)
-2.75 E 21.15<8354>72 294.4 S(he BSM w)-21.15 E(ould e)-.11 E
(xceed the link MTU the pack)-.165 E(et will be forw)-.11 E(arded o)-.11
E -.165(ve)-.165 G -.605(r.).165 G 21.15<8354>72 311 S
(he BSM includes information about more than one admin scope zone.)
-21.15 E(Let us initially consider only the former case; the pack)72
327.6 Q(et w)-.11 E(ould be too lar)-.11 E(ge because the set of)-.198 E
(group pre\214x)72 340.6 Q(es and the RPs for each group pre\214x are t\
oo long to \214t in one pack)-.165 E 2.75(et. The)-.11 F(BSR will)2.75 E
(then split the BSM across se)72 353.6 Q -.165(ve)-.275 G(ral BSMF pack)
.165 E(ets; each of these must be a well-formed BSMF)-.11 E(pack)72
366.6 Q(et in its o)-.11 E(wn right.)-.275 E
(If the BSR can split up the BSM so that dif)72 383.2 Q
(ferent group pre\214x)-.275 E
(es \(and their RP information\) can \214t)-.165 E(in dif)72 396.2 Q
(ferent fragments, then it should do so.)-.275 E
(If one of these BSMF pack)5.5 E(ets is then lost, the state)-.11 E
(from the pre)72 409.2 Q
(vious BSM for the group-pre\214x from the missing pack)-.275 E
(et will be retained.)-.11 E(Each)5.5 E(fragment that does arri)72 422.2
Q .33 -.165(ve w)-.275 H
(ill update the RP information for the group-pre\214x).165 E
(es contained in that)-.165 E(fragment, and the ne)72 435.2 Q 2.75(wg)
-.275 G(roup-to-RP mapping for those can be used immediately)-2.75 E 5.5
(.T)-.715 G(he information)-5.5 E
(from the missing fragment will be obtained when the BSM is ne)72 448.2
Q(xt transmitted.)-.165 E(In this case,)5.5 E(whilst the Fragment T)72
461.2 Q(ag must be set to the same v)-.88 E
(alue for all BSMFs comprising a single BSM,)-.275 E
(the tag is not actually used by routers recei)72 474.2 Q(ving the BSM.)
-.275 E(If the list of RPs for a single group-pre\214x is too long to \
\214t in a single BSMF pack)72 490.8 Q(et, then that)-.11 E
(information must be split across multiple BSMF pack)72 503.8 Q 2.75
(ets. In)-.11 F(this case, all the BSMF pack)2.75 E(ets)-.11 E
(comprising the information for that group-pre\214x must be recei)72
516.8 Q -.165(ve)-.275 G 2.75(db).165 G(efore the group-to-RP)-2.75 E
(mapping in use can be modi\214ed.)72 529.8 Q
(This is the purpose of the RP Count \214eld - a router recei)5.5 E
(ving)-.275 E(BSMF pack)72 542.8 Q(ets from the same BSM \(ie that ha)
-.11 E .33 -.165(ve t)-.22 H(he same fragment tag\) must w).165 E
(ait until the)-.11 E(BSMFs pro)72 555.8 Q
(viding RP Count RPs for that group-pre\214x ha)-.165 E .33 -.165(ve b)
-.22 H(een recei).165 E -.165(ve)-.275 G 2.75(db).165 G(efore the ne)
-2.75 E 2.75(wg)-.275 G(roup-)-2.75 E
(to-RP mapping can be used for that group-pre\214x.)72 568.8 Q
(In a single BSMF from such a lar)5.5 E(ge group-)-.198 E
(pre\214x is lost, then that entire group-pre\214x will ha)72 581.8 Q
.33 -.165(ve t)-.22 H 2.75(ow).165 G(ait until the ne)-2.86 E
(xt BSM is originated.)-.165 E(Ne)72 598.4 Q(xt we need to consider ho)
-.165 E 2.75(waB)-.275 G(SR w)-2.75 E(ould remo)-.11 E .33 -.165(ve g)
-.165 H(roup-pre\214x).165 E(es from the BSM.)-.165 E 2.75(Ar)5.5 G
(outer)-2.75 E(recei)72 611.4 Q
(ving a set of BSMFs cannot tell if a group-pre\214x is missing.)-.275 E
(If it has seen a group-pre\214x)5.5 E
(before, it must assume that that group-pre\214x still e)72 624.4 Q
(xists, and that the BSMF describing it has been)-.165 E 2.75(lost. It)
72 637.4 R(should retain this information for BS T)2.75 E
(imeout seconds.)-.385 E(Thus for a BSR to remo)5.5 E .33 -.165(ve a)
-.165 H
(group-pre\214x from the BSR, it should include that group-pre\214x, b)
72 650.4 Q(ut with a RP Count of zero, and)-.22 E
(it should resend this information in each BSM for BS T)72 663.4 Q
(imeout seconds.)-.385 E(Finally)72 680 Q 2.75(,w)-.715 G 2.75(ec)-2.75
G(ome to the case of fragments for the purpose of con)-2.75 E -.165(vey)
-.44 G(ing admin scope group-).165 E(pre\214x)72 693 Q 2.75(es. In)-.165
F(general, the information for each admin scope range is independent of\
 information)2.75 E(about other admin scope ranges.)72 706 Q
(As no BSMF is allo)5.5 E(wed to con)-.275 E .33 -.165(vey i)-.44 H
(nformation for more than).165 E
(one admin scope range, then the procedure abo)72 719 Q .33 -.165(ve a)
-.165 H(lso applies to BSMs that are fragmented due to).165 E
(Fenner/Handle)72 769 Q(y/K)-.165 E 174.765(ermode/Thaler Section)-.275
F 2.75(4.1.1. [P)2.75 F(age 18])-.165 E EP
%%Page: 19 19
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(admin scoping.)72 85 Q(Ho)5.5 E
(we)-.275 E -.165(ve)-.275 G .88 -.44(r, t).165 H 2.75(ot).44 G
(ime out all the state for an entire admin scope zone requires w)-2.75 E
(aiting)-.11 E(SZ T)72 98 Q(imeout rather than BS T)-.385 E
(imeout, as admin scope zones are not e)-.385 E(xpected to come and go)
-.165 E(frequently)72 111 Q(.)-.715 E/F1 11/Times-Bold@0 SF(4.2.)72 137
Q/F2 13/Times-Bold@0 SF(Candidate-RP-Adv)5.5 E(ertisement F)-.13 E
(ormat)-.325 E F0(Candidate-RP-Adv)72 153.6 Q
(ertisements are periodically unicast from the C-RPs to the BSR.)-.165 E
/F3 11/Courier@0 SF 125.4(0123)78.6 172.6 S 6.6
(01234567890123456789012345678901)78.6 185.6 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
198.6 Q(|PIM Ver| Type)72 211.6 Q 19.8(|R)13.2 G 19.8(eserved |)-19.8 F
72.6(Checksum |)72.6 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
224.6 Q 6.6(|P)72 237.6 S(refix Cnt)-6.6 E 19.8(|P)26.4 G 19.8
(riority |)-19.8 F 72.6(Holdtime |)72.6 F
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
250.6 Q 85.8(|R)72 263.6 S 6.6(PA)-85.8 G
(ddress \(Encoded-Unicast format\))-6.6 E(|)99 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
276.6 Q 79.2(|G)72 289.6 S(roup Address 1 \(Encoded-Group format\))-79.2
E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
302.6 Q 204.6(|.|)72 315.6 S 204.6(|.|)72 328.6 S 204.6(|.|)72 341.6 S
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
354.6 Q 79.2(|G)72 367.6 S(roup Address n \(Encoded-Group format\))-79.2
E(|)85.8 E
(+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+)72
380.6 Q F1(PIM V)72 403.2 Q(ersion, Reser)-1.1 E -.11(ve)-.11 G
(d, Checksum).11 E F0(Described in [1].)97 416.2 Q F1 -.814(Ty)72 432.8
S(pe).814 E F0(PIM Message T)97 445.8 Q 2.75(ype. V)-.88 F
(alue is 4 for a Candidate-RP-Adv)-1.221 E(ertisement Message.)-.165 E
F1(Pr)72 475.4 Q(e\214x Cnt)-.198 E F0(The number of encoded group addr\
esses included in the message; indicating the group)97 488.4 Q(pre\214x)
97 501.4 Q(es for which the C-RP is adv)-.165 E
(ertising. A Pre\214x Cnt of `0' implies all multicast groups,)-.165 E
(e.g. for IPv4 a pre\214x of 224.0.0.0 with mask length of 4.)97 514.4 Q
(If the C-RP is not con\214gured with)5.5 E
(Group-pre\214x information, the C-RP puts a def)97 527.4 Q(ault v)-.11
E(alue of `0' in this \214eld.)-.275 E F1(Priority)72 557 Q F0
(The `Priority' of the included RP)97 570 Q 2.75(,f)-1.221 G
(or the corresponding Encoded-Group Address \(if an)-2.75 E(y\).)-.165 E
(highest priority is `0' \(i.e. the lo)97 583 Q(wer the v)-.275 E
(alue of the `Priority' \214eld, the higher the priority\).)-.275 E(Thi\
s \214eld is stored at the BSR upon receipt along with the RP address a\
nd corresponding)97 596 Q(Encoded-Group Address.)97 609 Q F1(Holdtime)72
638.6 Q F0(The amount of time the adv)97 651.6 Q(ertisement is v)-.165 E
(alid. This \214eld allo)-.275 E(ws adv)-.275 E(ertisements to be aged)
-.165 E(out.)97 664.6 Q F1(RP Addr)72 694.2 Q(ess)-.198 E F0
(The address of the interf)97 707.2 Q(ace to adv)-.11 E
(ertise as a Candidate RP)-.165 E 5.5(.T)-1.221 G
(he format for this address is)-5.5 E(gi)97 720.2 Q -.165(ve)-.275 G
2.75(ni).165 G 2.75(nt)-2.75 G(he Encoded-Unicast address in [1].)-2.75
E(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015(ermode/Thaler Section)-.275
F 2.75(4.2. [P)2.75 F(age 19])-.165 E EP
%%Page: 20 20
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF(Gr)72 85
Q(oup Addr)-.198 E(ess-1..n)-.198 E F0(The group pre\214x)97 98 Q
(es for which the C-RP is adv)-.165 E 2.75(ertising. F)-.165 F
(ormat described in Encoded-Group-)-.165 E(Address in [1].)97 111 Q F1
(5.)72 137 Q/F2 14/Times-Bold@0 SF(Default V)5.5 E(alues f)-1.288 E
(or T)-.35 E(imers)-.252 E F1 -.198(Ti)72 163 S(mer Name: Bootstrap T)
.198 E(imer \(BST\))-.198 E .44 LW 503.996 177.35 72 177.35 DL -1.012
(Va)94.347 187.6 S(lue Name)1.012 E -1.012(Va)71.683 G 124.681
(lue Explanation)1.012 F 503.996 192.35 72 192.35 DL 503.996 194.35 72
194.35 DL F0(BS Period)94.347 204.6 Q(Def)83.486 E(ault: 60 secs)-.11 E
(Period between)376.676 204.6 Q(bootstrap messages)376.676 217.6 Q
503.996 222.35 72 222.35 DL(BS T)94.347 232.6 Q(imeout)-.385 E 2.75(2*B)
222.757 232.6 S(S_Period + 10)-2.75 E(seconds)222.757 245.6 Q
(Period after last BS)376.676 232.6 Q(message before BSR is)376.676
245.6 Q(timed out and election)376.676 258.6 Q(be)376.676 271.6 Q(gins)
-.165 E 503.996 276.35 72 276.35 DL(rand\(0, 5.0 secs\))222.757 286.6 Q
(rand_o)94.347 286.6 Q -.165(ve)-.165 G(rride).165 E
(Suppression period in)376.676 286.6 Q(BSR election to pre)376.676 299.6
Q -.165(ve)-.275 G(nt).165 E(thrashing)376.676 312.6 Q 503.996 317.35 72
317.35 DL 343.155 177.35 343.155 317.35 DL 189.236 177.35 189.236 317.35
DL 503.996 177.35 503.996 317.35 DL 72 177.35 72 317.35 DL F1 -.198(Ti)
72 344.6 S(mer Name: C-RP Expiry T).198 E(imer \(CET\(R\)\))-.198 E
503.999 358.95 72 358.95 DL -1.012(Va)90.529 369.2 S(lue Name)1.012 E
-1.012(Va)62.957 G 87.751(lue Explanation)1.012 F 503.999 373.95 72
373.95 DL 503.999 375.95 72 375.95 DL F0(C-RP T)90.529 386.2 Q 52.837
(imeout from)-.385 F 52.837(message Hold)2.75 F
(time from C-RP-Adv message)2.75 E 503.999 390.95 72 390.95 DL 299.408
358.95 299.408 390.95 DL 182.419 358.95 182.419 390.95 DL 503.999 358.95
503.999 390.95 DL 72 358.95 72 390.95 DL(C-RP Adv)72 408.8 Q
(ertisement messages are sent periodically with period C-RP-Adv-Period.)
-.165 E(C-RP-Adv-)5.5 E(Period def)72 421.8 Q(aults to 60 seconds.)-.11
E(The holdtime to be speci\214ed in a C-RP-Adv message should be set)5.5
E(to \(2.5 * C-RP-Adv-Period \).)72 434.8 Q F1 -.198(Ti)72 460.8 S
(mer Name: C-RP Adv).198 E(ertisement T)-.11 E(imer \(CRPT\))-.198 E
503.999 475.15 72 475.15 DL -1.012(Va)91.97 485.4 S(lue Name)1.012 E
-1.012(Va)82.625 G 117.935(lue Explanation)1.012 F 503.999 490.15 72
490.15 DL 503.999 492.15 72 492.15 DL F0 57.16(C-RP-Adv-Period Def)91.97
502.4 R(ault: 60 seconds)-.11 E(Period with which)378.495 502.4 Q
(periodic C-RP)378.495 515.4 Q(Adv)378.495 528.4 Q(ertisements are sent)
-.165 E(to BSR)378.495 541.4 Q 503.999 546.15 72 546.15 DL 348.54 475.15
348.54 546.15 DL 201.367 475.15 201.367 546.15 DL 503.999 475.15 503.999
546.15 DL 72 475.15 72 546.15 DL F1 -.198(Ti)72 573.4 S
(mer Name: Scope Zone Expiry T).198 E(imer \(SZT\(Z\)\))-.198 E 503.998
587.75 72 587.75 DL -1.012(Va)85.308 598 S(lue Name)1.012 E -1.012(Va)
16.5 G 5.5(lue Explanation)1.012 F 503.998 602.75 72 602.75 DL 503.998
604.75 72 604.75 DL F0(SZ T)85.308 615 Q 150.122(imeout 1500)-.385 F
(seconds)2.75 E(Interv)390.161 615 Q(al after which a)-.275 E
(scope zone will be)390.161 628 Q(timed out if the state is)390.161 641
Q(not refreshed)390.161 654 Q 503.998 658.75 72 658.75 DL 370.199 587.75
370.199 658.75 DL 270.699 587.75 270.699 658.75 DL 503.998 587.75
503.998 658.75 DL 72 587.75 72 658.75 DL(Fenner/Handle)72 769 Q(y/K)
-.165 E 191.265(ermode/Thaler Section)-.275 F 2.75(5. [P)2.75 F(age 20])
-.165 E EP
%%Page: 21 21
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E/F1 11/Times-Bold@0 SF(6.)72 85
Q/F2 14/Times-Bold@0 SF(Security Considerations)5.5 E F1(6.1.)72 111 Q
/F3 13/Times-Bold@0 SF -.26(Po)5.5 G(ssible Thr).26 E(eats)-.234 E F0
(Threats af)72 127.6 Q
(fecting the PIM BSR mechanism are primarily of tw)-.275 E 2.75(of)-.11
G(orms: denial of service attacks,)-2.75 E(and traf)72 140.6 Q(\214c di)
-.275 E -.165(ve)-.275 G(rsion attacks.).165 E(An attack)5.5 E
(er that sub)-.11 E -.165(ve)-.165 G(rts the BSR mechanism can pre).165
E -.165(ve)-.275 G(nt multicast).165 E(traf)72 153.6 Q
(\214c from reaching the intended recipients, can di)-.275 E -.165(ve)
-.275 G(rt multicast traf).165 E(\214c to a place where the)-.275 E 2.75
(yc)-.165 G(an)-2.75 E
(monitor it, and can potentially \215ood third parties with traf)72
166.6 Q(\214c.)-.275 E -.385(Tr)72 183.2 S(af).385 E(\214c can be pre)
-.275 E -.165(ve)-.275 G
(nted from reaching the intended recipients by one of tw).165 E 2.75(om)
-.11 G(echanisms:)-2.75 E 21.15<8353>72 199.8 S(ub)-21.15 E -.165(ve)
-.165 G(rting a BSM, and specifying RPs that w).165 E(on')-.11 E 2.75
(ta)-.198 G(ctually forw)-2.75 E(ard traf)-.11 E(\214c.)-.275 E 21.15
<8352>72 216.4 S -.165(eg)-21.15 G(istering with the BSR as a C-RP).165
E 2.75(,a)-1.221 G(nd then not forw)-2.75 E(arding traf)-.11 E(\214c.)
-.275 E -.385(Tr)72 233 S(af).385 E(\214c can be di)-.275 E -.165(ve)
-.275 G(rted to a place where it can be monitored by both of the abo)
.165 E .33 -.165(ve m)-.165 H(echanisms; in).165 E(this case the RPs w)
72 246 Q(ould forw)-.11 E(ard the traf)-.11 E(\214c, b)-.275 E
(ut are located so as to aid monitoring or man-in-the-)-.22 E
(middle attacks on the multicast traf)72 259 Q(\214c.)-.275 E 2.75(At)72
275.6 S(hird party can be \215ooded by either of the abo)-2.75 E .33
-.165(ve t)-.165 H .22 -.11(wo m).165 H
(echanisms by specifying the third party).11 E(as the RP)72 288.6 Q 2.75
(,a)-1.221 G(nd re)-2.75 E(gister)-.165 E(-encapsulated traf)-.22 E
(\214c will then be forw)-.275 E(arded to them.)-.11 E F1(6.2.)72 314.6
Q F3(Limiting Third-P)5.5 E(arty DoS Attacks)-.13 E F0
(The third party DoS attack abo)72 331.2 Q .33 -.165(ve c)-.165 H
(an be greatly reduced if PIM routers acting as DR do not).165 E
(continue to forw)72 344.2 Q(ard Re)-.11 E(gister traf)-.165 E
(\214c to the RP in the presence of ICMP Protocol Unreachable or)-.275 E
(ICMP Host Unreachable responses.)72 357.2 Q(If a PIM router sending Re)
5.5 E(gister pack)-.165 E(ets to an RP recei)-.11 E -.165(ve)-.275 G(s)
.165 E(one of these responses to a data pack)72 370.2 Q
(et it has sent, it should rate-limit the transmission of future)-.11 E
(Re)72 383.2 Q(gister pack)-.165 E
(ets to that RP for a short period of time.)-.11 E(As this does not af)
72 399.8 Q(fect interoperability)-.275 E 2.75(,t)-.715 G
(he precise details are left to the implementator to decide.)-2.75 E(Ho)
72 412.8 Q(we)-.275 E -.165(ve)-.275 G 2.75(rw).165 G 2.75(en)-2.75 G(o\
te that a router implementing such rate limiting must only do so if the\
 ICMP)-2.75 E(pack)72 425.8 Q(et correctly echoes part of a Re)-.11 E
(gister pack)-.165 E(et that w)-.11 E(as sent to the RP)-.11 E 5.5(.I)
-1.221 G 2.75(ft)-5.5 G(his check were not)-2.75 E
(made, then simply sending ICMP Unreachable pack)72 438.8 Q
(ets to the DR with the source address of the)-.11 E(RP spoofed w)72
451.8 Q(ould be suf)-.11 E
(\214cient to cause a denial-of-service attack on the multicast traf)
-.275 E<8c63>-.275 E(originating from that DR.)72 464.8 Q F1(6.3.)72
490.8 Q F3(BS Message Security)5.5 E F0(If a le)72 507.4 Q
(gitimate PIM router is compromised, there is little an)-.165 E 2.75(ys)
-.165 G(ecurity mechanism can do to)-2.75 E(pre)72 520.4 Q -.165(ve)
-.275 G(nt that router sub).165 E -.165(ve)-.165 G(rting PIM traf).165 E
(\214c in that domain.)-.275 E(Ho)5.5 E(we)-.275 E -.165(ve)-.275 G 2.75
(rw).165 G 2.75(er)-2.75 G(ecommend that)-2.75 E(implementors pro)72
533.4 Q
(vide a mechanism whereby a PIM router using the BSR mechanisms can be)
-.165 E(con\214gured with the IP addresses of v)72 546.4 Q
(alid BSR routers, and that an)-.275 E 2.75(yB)-.165 G 2.75(SM)-2.75 G
(essage from an)-2.75 E 2.75(yo)-.165 G(ther)-2.75 E
(BSR should then be dropped and logged as a security issue.)72 559.4 Q
1.76 -.88(We a)5.5 H(lso recommend that this not be).88 E
(enabled by def)72 572.4 Q(ault, as it mak)-.11 E
(es the initial con\214guration of a PIM domain problematic - it is the)
-.11 E(sort of feature that might be enabled once the con\214guration o\
f a domain has stabilized.)72 585.4 Q(The primary security requirement \
for BSR \(as for PIM\) is that it is possible to pre)72 602 Q -.165(ve)
-.275 G(nt hosts that).165 E(are not le)72 615 Q
(gitimate PIM routers, either within or outside the domain, from sub)
-.165 E -.165(ve)-.165 G(rting the BSR).165 E(mechanism.)72 628 Q
(The Bootstrap Message Processing Checks pre)72 644.6 Q -.165(ve)-.275 G
(nt a router from accepting a BS message from).165 E(outside of the PIM\
 Domain, as the source address on BS Messages must be an immediate PIM)
72 657.6 Q(neighbor)72 670.6 Q 5.5(.T)-.605 G(here is ho)-5.5 E(we)-.275
E -.165(ve)-.275 G 2.75(ras).165 G(mall windo)-2.75 E 2.75(wo)-.275 G
2.75(ft)-2.75 G(ime after a reboot where a PIM router will accept)-2.75
E 2.75(ab)72 683.6 S(ad BS Message unicast from an immediate neighbor)
-2.75 E 2.75(,a)-.44 G(nd it might be possible to unicast a BS)-2.75 E
(Message to a router during this interv)72 696.6 Q
(al from outside the domain, using the spoofed source)-.275 E
(address of a neighbor)72 709.6 Q 5.5(.T)-.605 G(his can be pre)-5.5 E
-.165(ve)-.275 G(nted if PMBRs perform source-address \214ltering to)
.165 E(pre)72 722.6 Q -.165(ve)-.275 G(nt pack).165 E(ets entering the \
PIM domain with IP source addresses that are infrastructure)-.11 E
(Fenner/Handle)72 769 Q(y/K)-.165 E 183.015(ermode/Thaler Section)-.275
F 2.75(6.3. [P)2.75 F(age 21])-.165 E EP
%%Page: 22 22
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(addresses in the PIM domain.)72
85 Q(The principle threat to BS Message security comes from hosts withi\
n the PIM domain that)72 101.6 Q(attempt to sub)72 114.6 Q -.165(ve)
-.165 G(rt the BSR mechanism.).165 E(The)5.5 E 2.75(ym)-.165 G
(ay be able to do this by sending PIM messages to)-2.75 E
(their local router)72 127.6 Q 2.75(,o)-.44 G 2.75(rb)-2.75 G 2.75(yu)
-2.75 G
(nicasting a BS message to another PIM router during the brief interv)
-2.75 E(al)-.275 E(after it has restarted.)72 140.6 Q
(All BS Messages SHOULD carry the Router Alert IP option.)72 170.2 Q
(If a PIM router recei)5.5 E -.165(ve)-.275 G 2.75(saB).165 G(S)-2.75 E
(Message that does not carry the router alert option, it SHOULD drop it\
 \(a con\214guration option)72 183.2 Q(should also be pro)72 196.2 Q
(vided to disable this check on a per)-.165 E(-interf)-.22 E
(ace basic for backw)-.11 E(ard compatibility)-.11 E
(with older PIM routers\).)72 209.2 Q(The Router Alert option allo)5.5 E
(ws a PIM router to perform checks on)-.275 E(unicast pack)72 222.2 Q
(ets it w)-.11 E(ould otherwise blindly forw)-.11 E 2.75(ard. All)-.11 F
(PIM routers should check that pack)2.75 E(ets)-.11 E(with Router Alert\
 that are not destined for the router itself are not PIM BootStrap mess\
ages.)72 235.2 Q(An)5.5 E(y)-.165 E(such pack)72 248.2 Q(ets should be \
dropped and logged as a possible security issue - it is ne)-.11 E -.165
(ve)-.275 G 2.75(ra).165 G(cceptable for)-2.75 E 2.75(aP)72 261.2 S
(IM BS message to tra)-2.75 E -.165(ve)-.22 G 2.75(lm).165 G
(ultiple IP hops.)-2.75 E(Most hosts that are lik)72 290.8 Q
(ely to attempt to sub)-.11 E -.165(ve)-.165 G(rt PIM BSR are lik).165 E
(ely to be located on leaf subnets.)-.11 E 1.76 -.88(We r)72 303.8 T
(ecommend that implementors pro).88 E
(vide a con\214guration option that speci\214es an interf)-.165 E
(ace is a)-.11 E(leaf subnet, and that no PIM pack)72 316.8 Q
(ets are accepted on such interf)-.11 E(aces.)-.11 E(On multi-access su\
bnets with multiple PIM routers and hosts that are not trusted, we reco\
mmend)72 333.4 Q(that IPsec AH is used to protect communication between\
 PIM routers, and that such routers are)72 346.4 Q
(con\214gured to drop and log communication attempts from an)72 359.4 Q
2.75(yh)-.165 G(ost that do not pass the)-2.75 E(authentication check.)
72 372.4 Q(When all the PIM routers are under the same administrati)5.5
E .33 -.165(ve c)-.275 H(ontrol, this).165 E
(authentication may use a con\214gured shared secret.)72 385.4 Q
(The securing of interactions between PIM)5.5 E(neighbors is discussed \
in more detail in the Security Considerations section of [1], and so we\
 do)72 398.4 Q(not discuss the details further here.)72 411.4 Q
(The same security mechanisms than can be used to secure)5.5 E(PIM Join\
, Prune and Assert messages should also be used to secure BS messages.)
72 424.4 Q/F1 11/Times-Bold@0 SF(6.4.)72 450.4 Q/F2 13/Times-Bold@0 SF
(C-RP-Adv)5.5 E(ertisement Security)-.13 E F0(Ev)72 467 Q
(en if it is not possible to sub)-.165 E -.165(ve)-.165 G
(rt BS Messages, an attack).165 E(er might be able to perform most of)
-.11 E(the same attacks by simply sending C-RP-Adv messages to the BSR \
specifying the attack)72 480 Q(er')-.11 E(s)-.605 E(choice of RPs.)72
493 Q(Thus it is necessary to control the sending of C-RP-Adv messages \
in essentially)5.5 E(the same w)72 506 Q
(ays that we control BS Messages.)-.11 E(Ho)5.5 E(we)-.275 E -.165(ve)
-.275 G .88 -.44(r, C).165 H(-RP-Adv messages are unicast and).44 E
(normally tra)72 519 Q -.165(ve)-.22 G 2.75(lm).165 G
(ultiple hops, so controlling them is a little harder)-2.75 E(.)-.605 E
1.76 -.88(We s)72 548.6 T(pecify that C-RP-Adv messages SHOULD also car\
ry the Router Alert IP option, and that the).88 E(BSR SHOULD by def)72
561.6 Q
(ault drop and log C-RP-Adv messages that do not carry this option.)-.11
E(Setting)5.5 E(Router Alert on these pack)72 574.6 Q
(ets is practical because the rate of C-RP-Adv messages should be v)-.11
E(ery)-.165 E(lo)72 587.6 Q 1.43 -.715(w, s)-.275 H 2.75(ot).715 G(he e)
-2.75 E(xtra load on routers forw)-.165 E(arding these pack)-.11 E
(ets will be insigni\214cant.)-.11 E(All PIM routers)5.5 E(forw)72 600.6
Q(arding such a pack)-.11 E
(et are then capable of checking whether the pack)-.11 E
(et came from a v)-.11 E(alid)-.275 E(neighbor)72 613.6 Q 5.5(.O)-.605 G
2.75(ni)-5.5 G(nterf)-2.75 E(aces that are con\214gured to be leaf subn\
ets, all C-RP-Adv messages should be)-.11 E 2.75(dropped. On)72 626.6 R
(multi-access subnets with multiple PIM routers and hosts that are not \
trusted, the)2.75 E(router can at least check that the source MA)72
639.6 Q 2.75(Ca)-.44 G(ddress is that of a v)-2.75 E(alid PIM neighbor)
-.275 E 5.5(.P)-.605 G(MBRs)-5.5 E
(should ensure that no C-RP-Adv messages enter the domain from an e)72
652.6 Q(xternal neighbor)-.165 E(.)-.605 E -.165(Fo)72 682.2 S 2.75(rt)
.165 G(rue security)-2.75 E 2.75(,w)-.715 G 2.75(er)-2.75 G
(ecommend that all C-RPs are con\214gured to use IPsec authentication.)
-2.75 E(The)5.5 E(authentication process for a C-RP-Adv message between\
 a C-RP and the BSR is identical to the)72 695.2 Q
(authentication process for PIM Re)72 708.2 Q
(gister messages between a DR and the rele)-.165 E -.275(va)-.275 G
(nt RP).275 E 2.75(,e)-1.221 G(xcept that)-2.915 E
(there will normally be fe)72 721.2 Q
(wer C-RPs in a domain than there are DRs, so k)-.275 E .33 -.165(ey m)
-.11 H(anagement is a little).165 E(Fenner/Handle)72 769 Q(y/K)-.165 E
183.015(ermode/Thaler Section)-.275 F 2.75(6.4. [P)2.75 F(age 22])-.165
E EP
%%Page: 23 23
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(simpler)72 85 Q 5.5(.W)-.605 G
2.75(ed)-6.38 G 2.75(on)-2.75 G
(ot describe the details of this process further here, b)-2.75 E
(ut refer to the Security)-.22 E(Considerations section of [1]. Note th\
at the use of cryptographic security for C-RP-Advs does not)72 98 Q
(remo)72 111 Q .33 -.165(ve t)-.165 H
(he need for the non-cryptographic mechanisms, as e).165 E
(xplained belo)-.165 E -.715(w.)-.275 G/F1 11/Times-Bold@0 SF(6.5.)72
137 Q/F2 13/Times-Bold@0 SF(Denial of Ser)5.5 E(vice using IPsec)-.13 E
F0(An additional concern is that of Denial-of-Service attacks caused by\
 sending high v)72 153.6 Q(olumes of BS)-.22 E
(Messages or C-RP-Adv messages with in)72 166.6 Q -.275(va)-.44 G
(lid IPsec authentication information.).275 E(It is possible)5.5 E
(that these messages could o)72 179.6 Q -.165(ve)-.165 G
(rwhelm the CPU resources of the recipient.).165 E
(The non-cryptographic security mechanisms abo)72 196.2 Q .33 -.165
(ve p)-.165 H(re).165 E -.165(ve)-.275 G
(nt unicast BS messages from tra).165 E -.165(ve)-.22 G(ling).165 E
(multiple hops, and constrain who can originate such messages.)72 209.2
Q(Ho)5.5 E(we)-.275 E -.165(ve)-.275 G .88 -.44(r, i).165 H 2.75(ti).44
G 2.75(so)-2.75 G -.165(bv)-2.75 G(iously).165 E
(important that PIM Messages that are required to ha)72 222.2 Q .33
-.165(ve R)-.22 H(outer Alert check).165 E(ed are check)-.11 E
(ed for this)-.11 E(option before the IPsec AH is check)72 235.2 Q 2.75
(ed. Thus)-.11 F(the remaining vulnerability primarily e)2.75 E
(xists for)-.165 E
(hosts on multi-access subnets containing more than one PIM router)72
248.2 Q 5.5(.A)-.605 G(PIM router recei)-2.75 E(ving PIM)-.275 E(pack)72
261.2 Q(ets with Router Alert set from such a subnet should already be \
checking that the source MA)-.11 E(C)-.44 E(address is that of a v)72
274.2 Q(alid PIM neighbor)-.275 E 2.75(,b)-.44 G
(ut this is hardly strong security)-2.97 E 5.5(.I)-.715 G 2.75(na)-5.5 G
(ddition, we)-2.75 E(recommend that rate-limiting mechanisms can be con\
\214gured, to be applied to the forw)72 287.2 Q(arding of)-.11 E
(unicast PIM pack)72 300.2 Q(ets containing Router Alert options.)-.11 E
(The rate-limiter MUST independently rate-)5.5 E(limit dif)72 313.2 Q
(ferent types of PIM pack)-.275 E(ets - for e)-.11 E
(xample a \215ood of C-RP-Adv messages MUST NO)-.165 E(T)-.44 E
(cause a rate limiter to drop lo)72 326.2 Q(w-rate BS Messages.)-.275 E
(Such a rate-limiter might itself be used to)5.5 E
(cause a denial of service attack by causing v)72 339.2 Q(alid pack)
-.275 E(ets to be dropped, b)-.11 E(ut in practice this is)-.22 E
(more lik)72 352.2 Q
(ely to constrain bad PIM Messages close to their origin.)-.11 E
(In addition, the rate limiter will)5.5 E(pre)72 365.2 Q -.165(ve)-.275
G(nt attacks on PIM from af).165 E(fecting other acti)-.275 E
(vity on the destination router)-.275 E 2.75(,s)-.44 G(uch as unicast)
-2.75 E(routing.)72 378.2 Q F1(7.)72 404.2 Q/F3 14/Times-Bold@0 SF -.7
(Au)5.5 G(thors' Addr).7 E(esses)-.252 E F0(Bill Fenner)108 423.2 Q
-1.221(AT)108 436.2 S(&T Labs - Research)1.221 E(75 W)108 449.2 Q(illo)
-.44 E 2.75(wR)-.275 G(oad)-2.75 E(Menlo P)108 462.2 Q(ark, CA 94025)
-.165 E(fenner@research.att.com)108 475.2 Q(Mark Handle)108 500.2 Q(y)
-.165 E -.44(AC)108 513.2 S(IRI/ICSI).44 E(1947 Center St, Suite 600)108
526.2 Q(Berk)108 539.2 Q(ele)-.11 E 1.43 -.715(y, C)-.165 H 2.75(A9).715
G(4708)-2.75 E(mjh@aciri.or)108 552.2 Q(g)-.198 E(Roger K)108 577.2 Q
(ermode)-.275 E(Motorola Australian Research Centre)108 590.2 Q(Lock)108
603.2 Q(ed Bag 5028)-.11 E(Botan)108 616.2 Q 5.5(yN)-.165 G 2.75
(SW 1455,)-5.5 F(Australia)108 629.2 Q(Roger)108 642.2 Q(.K)-.605 E
(ermode@motorola.com)-.275 E(Fenner/Handle)72 769 Q(y/K)-.165 E 191.265
(ermode/Thaler Section)-.275 F 2.75(7. [P)2.75 F(age 23])-.165 E EP
%%Page: 24 24
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(INTERNET)72 49 Q 71.587(-DRAFT Expires:)-1.012 F
(January 2002)2.75 E(July 2001)123.726 E(Da)108 85 Q(vid Thaler)-.22 E
(Microsoft Corporation)108 98 Q(One Microsoft W)108 111 Q(ay)-.88 E
(Redmond, W)108 124 Q 2.75(A9)-1.32 G(8052)-2.75 E
(dthaler@Exchange.Microsoft.com)108 137 Q/F1 11/Times-Bold@0 SF(8.)72
182 Q/F2 14/Times-Bold@0 SF(Refer)5.5 E(ences)-.252 E F0([1] W)72 198.6
Q 2.75(.F)-1.012 G(enner)-2.75 E 2.75(,M)-.44 G 2.75(.H)-2.75 G(andle)
-2.75 E 1.43 -.715(y, H)-.165 H 2.75(.H).715 G(olbrook, I. K)-2.75 E
(ouv)-.385 E(elas, "Protocol Independent Multicast - Sparse)-.165 E
(Mode \(PIM-SM\): Protocol Speci\214cation \(Re)97 211.6 Q
(vised\)", Internet Draft draft-ietf-pim-sm-)-.275 E(v2-ne)97 224.6 Q
(w-03.ps)-.275 E([2] D. Estrin et al., "Protocol Independent Multicast \
- Sparse Mode \(PIM-SM\): Protocol)72 241.2 Q
(Speci\214cation", RFC 2362, June 1998 \(no)97 254.2 Q 2.75(wo)-.275 G
(bsolete\).)-2.75 E([3] W)72 270.8 Q 2.75(.F)-1.012 G(enner)-2.75 E 2.75
(,")-.44 G(Internet Group Management Protocol, V)-2.75 E
(ersion 2", RFC 2236, No)-1.221 E 2.75(v1)-.165 G(997.)-2.75 E
([4] S. Deering , W)72 287.4 Q 2.75(.F)-1.012 G
(enner , B. Haberman, "Multicast Listener Disco)-2.75 E -.165(ve)-.165 G
(ry \(MLD\) for IPv6", RFC).165 E(2710, Oct 1999.)97 300.4 Q([5] IAN)72
317 Q(A, "Address F)-.385 E(amily Numbers", link)-.165 E
(ed from http://www)-.11 E(.iana.or)-.715 E(g/numbers.html)-.198 E F1
(9.)72 343 Q F2(Ackno)5.5 E(wledgments)-.14 E F0(PIM-SM w)72 359.6 Q
(as designed o)-.11 E -.165(ve)-.165 G 2.75(rm).165 G(an)-2.75 E 2.75
(yy)-.165 G(ears by a lar)-2.75 E
(ge group of people, including ideas from Deborah)-.198 E
(Estrin, Dino F)72 372.6 Q(arinacci, Ahmed Helmy)-.165 E 2.75(,S)-.715 G
(te)-2.75 E .33 -.165(ve D)-.275 H(eering, V).165 E
(an Jacobson, C. Liu, Puneet Sharma,)-1.221 E(Liming W)72 385.6 Q(ei, T)
-.88 E(om Pusateri, T)-.88 E(on)-.88 E 2.75(yB)-.165 G
(allardie, Scott Brim, Jon Cro)-2.75 E(wcroft, P)-.275 E
(aul Francis, Joel)-.165 E
(Halpern, Horst Hodel, Polly Huang, Stephen Ostro)72 398.6 Q
(wski, Lixia Zhang, Girish Chandranmenon,)-.275 E -.165(Pa)72 411.6 S
(vlin Radosla)-.055 E -2.475 -.22(vo v)-.22 H 2.75(,J)-.495 G
(ohn Zwiebel, Isidor K)-2.75 E(ouv)-.385 E(elas and Hugh Holbrook.)-.165
E(This BSR speci\214cation)5.5 E(dra)72 424.6 Q(ws hea)-.165 E
(vily on te)-.22 E(xt from RFC 2362.)-.165 E(Fenner/Handle)72 769 Q(y/K)
-.165 E 191.265(ermode/Thaler Section)-.275 F 2.75(9. [P)2.75 F(age 24])
-.165 E EP
%%Trailer
end
%%EOF
