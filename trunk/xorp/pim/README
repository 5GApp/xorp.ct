#
# $XORP: xorp/pim/README,v 1.1.1.1 2002/12/11 23:56:10 hodson Exp $
#

Protocol Independent Multicast-Sparse Mode (PIM-SM) Implementation
============================================

This directory contains the XORP implementation of the PIM-SM protocol.

Configuration
=============

PIM-SM like most Xorp processes does not take its configuration
parameters from the command line. Its parameters are provided via
XRLs. At the very least a PIM-SM process must be provided with
the set of network interfaces to enable for multicast.

Startup
=======

In normal operation, PIM-SM would be started by the XORP router manager
process, not directly from the command line.  

To use PIM-SM, you must have PIM-capable kernel. For information
about PIM-support in the UNIX kernel, existing patches, and
configuration, see the README files from the pimd distribution from USC:

http://netweb.usc.edu/pim/pimd/


For testing and debugging purposes, PIM-SM can be manually started.  The
Xorp PIM-SM process assumes that the XRL finder, the MFEA and MLD/IGMP
are already running. However, the binary program ``test_pim'' already
contains them as well, therefore it is sufficient to start only this
program.

After ``test_pim'' is started, the MFEA, MLD/IGMP, and PIM-SM are
disabled by default. To start them, and to configure their operation,
as well as the PIM-SM operation, run script ``configure_pim''.
Note that it MUST be run from the ``pim'' directory.

However, before running ``configure_pim'', you must configure
it for each router:

 - Add an entry for each router under "case $HOSTNAME in" with the
   set of network interfaces to enable, and with the interface whose
   address the router will use as the Candidate-BSR or Candidate-RP
   addresses. Example:

	xorp1)
	ENABLE_VIFS="dc1 dc2 dc4"
	CAND_BSR_VIF="dc1"
	CAND_RP_VIF="dc1"
	;;

 - If you don't want to configure the PIM-SM router as a Candidate-BSR
   and/or a Candidate-RP, then comment-out the CAND_BSR_VIF
   or CAND_RP_VIF respectively.

 - If you want to configure static RPs, add all IP addresses to the
   variable STATIC_RPS:

	STATIC_RPS="10.2.0.1 10.4.0.2"

 - By default, ``test_pim'' will log all protocol-related messages.
   To disable them, comment-out the following variables:

	MFEA_ENABLE_LOG_TRACE=yes
	MLD6IGMP_ENABLE_LOG_TRACE=yes
	PIM_ENABLE_LOG_TRACE=yes

 - After PIM-SM is started, if you want to send a single XRL command
   to it and change some of its configuration, you can use the command
   ./command_pim <xrl_command> [xrl_command_arguments ... ]
   
   The list of all XRL commands and their arguments are in
   ``xrl_pim_shell_funcs.sh''

 - After PIM-SM is started, if you want to access its internal
   information, you can use the built-in CLI:
     telnet localhost 12000
   If you want to enable access from other subnets other than the local
   host only, add the corresponding subnet to test_pim.cc under
   "CLI access".

   Currently, the CLI supports primarily "show" commands. For example,
   "show pim interface" will show the list of all interfaces known to
   PIM and their status. At each moment you can press <TAB> for the
   list of existing commands at each level, and a brief description
   of them. Command-line editing is similar to tcsh: e.g., Ctrl-A and
   Ctrl-E to go to the beginning or end of the current line, Ctrl-A
   to kill the remaining part of the current line, etc.
   To exit, press Ctrl-D when you are on a new empty line.

Documentation
=============

The MFEA architecture is described in:
	$(XORP)/docs/pim

The programming documentation is in:
	$(XORP)/docs/kdoc/html/pim

Testing
=======

Currently, the PIM-SM testing is performed manually, by starting
PIM-SM on a number of testbed machines. All tests performed so far are
described in $(XORP)/docs/pim_testsuite/pim_testsuite.ps

In the future, automated testing will be added, similar to
the BGP testing framework.

Status
======

Currently (note: March 4, 2003), the PIM-SM implementation is based
on the specification in the following documents:

 * draft-ietf-pim-sm-v2-new-05.{ps,txt} (The core PIM-SM specification).
 * draft-ietf-pim-sm-bsr-03.{ps,txt} (The Bootstrap mechanism).

The only major features not implemented yet are SSM support and security.

Many detailed tests have been performed so far, but there is still a
large number of tests to complete.
Further, even though IPv6 support for PIM-SM has been implemented as well,
it has not been tested yet.
